<!DOCTYPE html>
<!-- saved from url=(0091)https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/ -->
<html lang="en" class="wf-robotoslab-n4-active wf-sourcesanspro-n4-active wf-sourcesanspro-i4-active wf-sourcesanspro-n7-active wf-sourcesanspro-i7-active wf-active"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://smsagent.blog/xmlrpc.php">

<title>PowerShell Tip! Create Background Jobs with a Custom Class</title>
<script src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/webfont.js.download" type="text/javascript" async=""></script><script type="text/javascript">
  WebFontConfig = {"google":{"families":["Roboto+Slab:r:latin,latin-ext","Source+Sans+Pro:r,i,b,bi:latin,latin-ext"]}};
  (function() {
    var wf = document.createElement('script');
    wf.src = 'https://s0.wp.com/wp-content/plugins/custom-fonts/js/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
	})();
</script><style id="jetpack-custom-fonts-css">.wf-active body, .wf-active button, .wf-active input, .wf-active select, .wf-active textarea{font-family:"Source Sans Pro",sans-serif}.wf-active pre{font-family:"Source Sans Pro",sans-serif}.wf-active code, .wf-active kbd, .wf-active tt, .wf-active var{font-family:"Source Sans Pro",sans-serif}.wf-active h1, .wf-active h2, .wf-active h3, .wf-active h4, .wf-active h5, .wf-active h6{font-family:"Roboto Slab",serif;font-weight:400;font-style:normal}.wf-active h1{font-style:normal;font-weight:400}.wf-active h2{font-style:normal;font-weight:400}.wf-active h3{font-style:normal;font-weight:400}.wf-active h4{font-style:normal;font-weight:400}.wf-active h5{font-style:normal;font-weight:400}.wf-active h6{font-style:normal;font-weight:400}.wf-active .site-title{font-family:"Roboto Slab",serif;font-weight:400;font-style:normal}.wf-active .site-description{font-family:"Roboto Slab",serif;font-style:normal;font-weight:400}.wf-active .entry-author h2, .wf-active .entry-author h3{font-style:normal;font-weight:400}.wf-active .comments-title{font-style:normal;font-weight:400}.wf-active h2.widget-title{font-style:normal;font-weight:400}.wf-active .widget-grofile h4{font-style:normal;font-weight:400}.wf-active .entry-content div#jp-relatedposts h3.jp-relatedposts-headline, .wf-active .entry-content div.sharedaddy h3, .wf-active .entry-content div.sharedaddy h3.sd-title{font-family:"Roboto Slab",serif;font-weight:400;font-style:normal}.wf-active .entry-content div#jp-relatedposts h3.jp-relatedposts-headline em{font-weight:400;font-style:normal}.wf-active ul.products li.product .woocommerce-loop-category__title, .wf-active ul.products li.product .woocommerce-loop-product__title{font-family:"Roboto Slab",serif;font-style:normal;font-weight:400}@media (min-width: 60em){.wf-active h1{font-style:normal;font-weight:400}}@media (min-width: 60em){.wf-active h2{font-style:normal;font-weight:400}}@media (min-width: 60em){.wf-active h3{font-style:normal;font-weight:400}}@media (min-width: 60em){.wf-active h4{font-style:normal;font-weight:400}}@media (min-width: 60em){.wf-active h5{font-style:normal;font-weight:400}}@media (min-width: 60em){.wf-active h6{font-style:normal;font-weight:400}}@media (min-width: 60em){.wf-active .site-title{font-style:normal;font-weight:400}}@media (min-width: 60em){.wf-active .site-description{font-style:normal;font-weight:400}}</style>
<meta name="robots" content="max-image-preview:large">

<!-- Async WordPress.com Remote Login -->

<link rel="dns-prefetch" href="https://s2.wp.com/">
<link rel="dns-prefetch" href="https://smsagent.wordpress.com/">
<link rel="dns-prefetch" href="https://s0.wp.com/">
<link rel="dns-prefetch" href="https://fonts.googleapis.com/">
<link rel="alternate" type="application/rss+xml" title=" » Feed" href="https://smsagent.blog/feed/">
<link rel="alternate" type="application/rss+xml" title=" » Comments Feed" href="https://smsagent.blog/comments/feed/">
<link rel="alternate" type="application/rss+xml" title=" » PowerShell Tip! Create Background Jobs with a Custom Class Comments Feed" href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/feed/">
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
			<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s2.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1625065786h&ver=5.8.1-alpha-51081"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/wp-emoji-release.min.js.download" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="all-css-0-1" href="./PowerShell Tip! Create Background Jobs with a Custom Class_files/saved_resource(2)" type="text/css" media="all">
<style id="wp-block-library-inline-css">
.has-text-align-justify {
	text-align:justify;
}
</style>
<link crossorigin="anonymous" rel="stylesheet" id="lodestar_fonts_url-css" href="./PowerShell Tip! Create Background Jobs with a Custom Class_files/css" media="all">
<link rel="stylesheet" id="all-css-2-1" href="./PowerShell Tip! Create Background Jobs with a Custom Class_files/saved_resource(3)" type="text/css" media="all">
<link rel="stylesheet" id="print-css-3-1" href="./PowerShell Tip! Create Background Jobs with a Custom Class_files/global-print.css" type="text/css" media="print">
<style id="jetpack-global-styles-frontend-style-inline-css">
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link rel="stylesheet" id="all-css-6-1" href="./PowerShell Tip! Create Background Jobs with a Custom Class_files/saved_resource(4)" type="text/css" media="all">
<script id="jetpack_related-posts-js-extra">
var related_posts_js_options = {"post_heading":"h4"};
</script>
<script id="wpcom-actionbar-placeholder-js-extra">
var actionbardata = {"siteID":"63076196","siteName":"smsagent.blog","siteURL":"https:\/\/smsagent.blog","siteHost":"smsagent.blog","icon":"<img alt='' src='https:\/\/smsagent.files.wordpress.com\/2017\/05\/cropped-smsagent-11.png?w=50' class='avatar avatar-50' height='50' width='50' \/>","canManageOptions":"","canCustomizeSite":"","isFollowing":"","themeSlug":"pub\/lodestar","signupURL":"https:\/\/wordpress.com\/start\/","loginURL":"https:\/\/wordpress.com\/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fsmsagent.blog%252F2017%252F02%252F17%252Fpowershell-tip-create-background-jobs-with-a-custom-class%252F","themeURL":"https:\/\/wordpress.com\/theme\/lodestar\/","xhrURL":"https:\/\/smsagent.blog\/wp-admin\/admin-ajax.php","nonce":"f8e0dfb4f6","isSingular":"1","isFolded":"","isLoggedIn":"","isMobile":"","subscribeNonce":"<input type=\"hidden\" id=\"_wpnonce\" name=\"_wpnonce\" value=\"52a593cd3d\" \/>","referer":"https:\/\/smsagent.blog\/2017\/02\/17\/powershell-tip-create-background-jobs-with-a-custom-class\/","canFollow":"1","feedID":"91845975","statusMessage":"","customizeLink":"https:\/\/smsagent.wordpress.com\/wp-admin\/customize.php?url=https%3A%2F%2Fsmsagent.wordpress.com%2F2017%2F02%2F17%2Fpowershell-tip-create-background-jobs-with-a-custom-class%2F","postID":"3388","shortlink":"https:\/\/wp.me\/p4gF00-SE","canEditPost":"","editLink":"https:\/\/wordpress.com\/post\/smsagent.blog\/3388","statsLink":"https:\/\/wordpress.com\/stats\/post\/3388\/smsagent.blog","i18n":{"view":"View site","follow":"Follow","following":"Following","edit":"Edit","login":"Log in","signup":"Sign up","customize":"Customize","report":"Report this content","themeInfo":"Get theme: Lodestar","shortlink":"Copy shortlink","copied":"Copied","followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/read\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","editSubs":"Manage subscriptions","viewReader":"View site in Reader","viewReadPost":"View post in Reader","subscribe":"Sign me up","enterEmail":"Enter your email address","followers":"Join 2,110 other followers","alreadyUser":"Already have a WordPress.com account? <a href=\"https:\/\/wordpress.com\/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fsmsagent.blog%252F2017%252F02%252F17%252Fpowershell-tip-create-background-jobs-with-a-custom-class%252F\">Log in now.<\/a>","stats":"Stats","notifyNewPosts":"Notify me of new posts","notifyNewPostsDetails":"Receive web and mobile notifications for new posts from this site.","emailNewPosts":"Email me new posts","emailNewPostsDetails":"You can customize your notification settings further <a href=\"https:\/\/wordpress.com\/following\/manage?s=smsagent.blog\">here<\/a>.","emailNewComments":"Email me new comments"}};
</script>
<script crossorigin="anonymous" type="text/javascript" src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/saved_resource(5)"></script>
<script type="text/javascript">
	window.addEventListener( 'DOMContentLoaded', function() {
		rltInitialize( {"token":null,"iframeOrigins":["https:\/\/widgets.wp.com"]} );
	} );
</script>
<link rel="stylesheet" id="all-css-0-2" href="./PowerShell Tip! Create Background Jobs with a Custom Class_files/style.css" type="text/css" media="all">
<!--[if lt IE 8]>
<link rel='stylesheet' id='highlander-comments-ie7-css'  href='https://s2.wp.com/wp-content/mu-plugins/highlander-comments/style-ie7.css?m=1351637563h&#038;ver=20110606' media='all' />
<![endif]-->
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://smsagent.wordpress.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s1.wp.com/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress.com">
<link rel="canonical" href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/">
<link rel="shortlink" href="https://wp.me/p4gF00-SE">
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/?format=json&amp;url=https%3A%2F%2Fsmsagent.blog%2F2017%2F02%2F17%2Fpowershell-tip-create-background-jobs-with-a-custom-class%2F&amp;for=wpcom-auto-discovery"><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/?format=xml&amp;url=https%3A%2F%2Fsmsagent.blog%2F2017%2F02%2F17%2Fpowershell-tip-create-background-jobs-with-a-custom-class%2F&amp;for=wpcom-auto-discovery">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article">
<meta property="og:title" content="PowerShell Tip! Create Background Jobs with a Custom Class">
<meta property="og:url" content="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/">
<meta property="og:description" content="PowerShell 5 introduced the capability to create custom classes. Classes are a convenient way to create an object with your own custom definition, and can include properties and methods. There coul…">
<meta property="article:published_time" content="2017-02-17T17:09:55+00:00">
<meta property="article:modified_time" content="2017-02-17T17:09:55+00:00">
<meta property="og:image" content="https://smsagent.files.wordpress.com/2017/02/multi.png">
<meta property="og:image:width" content="766">
<meta property="og:image:height" content="250">
<meta property="og:locale" content="en_US">
<meta name="twitter:creator" content="@trevor_smsagent">
<meta name="twitter:site" content="@trevor_smsagent">
<meta name="twitter:text:title" content="PowerShell Tip! Create Background Jobs with a Custom Class">
<meta name="twitter:image" content="https://smsagent.files.wordpress.com/2017/02/multi.png?w=640">
<meta name="twitter:card" content="summary_large_image">
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom">

<!-- End Jetpack Open Graph Tags -->
<link rel="openid.server" href="https://smsagent.blog/?openidserver=1">
<link rel="openid.delegate" href="https://smsagent.blog/">
<link rel="search" type="application/opensearchdescription+xml" href="https://smsagent.blog/osd.xml" title="">
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com">
<meta name="theme-color" content="#f1f1f1">
<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>		<style type="text/css">
			.recentcomments a {
				display: inline !important;
				padding: 0 !important;
				margin: 0 !important;
			}

			table.recentcommentsavatartop img.avatar, table.recentcommentsavatarend img.avatar {
				border: 0px;
				margin: 0;
			}

			table.recentcommentsavatartop a, table.recentcommentsavatarend a {
				border: 0px !important;
				background-color: transparent !important;
			}

			td.recentcommentsavatarend, td.recentcommentsavatartop {
				padding: 0px 0px 1px 0px;
				margin: 0px;
			}

			td.recentcommentstextend {
				border: none !important;
				padding: 0px 0px 2px 10px;
			}

			.rtl td.recentcommentstextend {
				padding: 0px 10px 2px 0px;
			}

			td.recentcommentstexttop {
				border: none;
				padding: 0px 0px 0px 10px;
			}

			.rtl td.recentcommentstexttop {
				padding: 0px 10px 0px 0px;
			}
		</style>
		<meta name="application-name" content="WordPress.com"><meta name="msapplication-window" content="width=device-width;height=device-height"><meta name="msapplication-task" content="name=Subscribe;action-uri=https://smsagent.blog/feed/;icon-uri=https://smsagent.files.wordpress.com/2017/05/cropped-smsagent-11.png?w=16"><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=https://s1.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=https://s1.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=https://s1.wp.com/i/favicon.ico"><meta name="description" content="PowerShell 5 introduced the capability to create custom classes. Classes are a convenient way to create an object with your own custom definition, and can include properties and methods. There could be many potential use cases for such a custom class, but here&#39;s one that is handy: background jobs. PowerShell comes with some cmdlets for…">
	<style type="text/css">
			.site-title,
		.site-description {
			position: absolute;
			clip: rect(1px, 1px, 1px, 1px);
		}
		</style>
	<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #f1f1f1; }
</style>
	<link rel="amphtml" href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/amp/"><style type="text/css" id="custom-colors-css">
	body .header-top a:hover,
	body .header-top a:focus,
	.menu-toggle:hover,
	.menu-toggle:focus,
	.site-top-content-2,
	.site-footer .jetpack-social-navigation a:hover,
	.site-footer .jetpack-social-navigation a:focus {
		opacity: 0.8;
	}

	body .header-top #site-navigation a:hover,
	body .header-top #site-navigation a:focus {
		opacity: 1.0;
	}

	body .site-branding,
	body .site-branding a {
		color: #fff;
	}

	body .site-description,
	body .site-description a {
		color: #ccc;
	}

	pre,
	mark,
	ins {
		background: rgba(0,0,0,0.15);
	}

	.entry-content h1,
	.entry-content h2,
	.panel-content .entry-title,
	.entry-meta {
		opacity: 0.6;
	}

	.lodestar-intro .entry-content {
		opacity: 0.7;
	}

	.entry-content h5,
	.entry-content h6 {
		opacity: 0.8;
	}

	button:hover,
	button:focus,
	input[type="button"]:hover,
	input[type="button"]:focus,
	input[type="reset"]:hover,
	input[type="reset"]:focus,
	input[type="submit"]:hover,
	input[type="submit"]:focus,
	#infinite-handle span button:hover,
	#infinite-handle span button:focus,
	.woocommerce-page .button:hover,
	.woocommerce-page .button:focus,
	.site-header-cart .button:hover,
	.site-header-cart .button:focus {
		opacity: 0.8;
	}

	table.shop_table {
		border: none;
	}

	table.shop_table th,
	.woocommerce-checkout-payment .payment_box {
		background: rgba(0,0,0,0.15);
	}

	@media only screen and ( max-width: 59.9999em ) {
		.main-navigation li:hover,
		.main-navigation li:focus,
		.main-navigation a:hover,
		.main-navigation a:focus,
		.main-navigation ul ul {
			background: transparent !important;
		}
	}

	@media only screen and ( min-width: 60em ) {
		.main-navigation ul,
		#top-menu {
			background-color: transparent;
		}
	}

.site-footer .widget-area { color: #666666;}
input[type="text"]:focus,
		input[type="email"]:focus,
		input[type="url"]:focus,
		input[type="password"]:focus,
		input[type="search"]:focus,
		input[type="number"]:focus,
		input[type="tel"]:focus,
		input[type="range"]:focus,
		input[type="date"]:focus,
		input[type="month"]:focus,
		input[type="week"]:focus,
		input[type="time"]:focus,
		input[type="datetime"]:focus,
		input[type="datetime-local"]:focus,
		input[type="color"]:focus,
		textarea:focus,
		.post-navigation .nav-links,
		.entry-author { border-color: #757575;}
.header-top,
		.header-top a,
		.header-top a:visited,
		.header-top a:hover,
		.header-top a:focus,
		.site-top-content span.site-top-content-2,
		.menu-toggle,
		.menu-toggle:hover,
		.menu-toggle:focus,
		.site-info,
		.site-info a,
		.site-info:visited { color: #FFFFFF;}
.menu-toggle,
		.menu-toggle:hover,
		.menu-toggle:focus { border-color: #FFFFFF;}
.woocommerce-message:before,
			.woocommerce-info:before,
			.woocommerce-error:before,
			.woocommerce-noreviews:before,
			p.no-comments:before { color: #FFFFFF;}
.site-header-cart .cart-contents .count { color: #FFFFFF;}
.onsale { color: #FFFFFF;}
input[type="text"],
		input[type="email"],
		input[type="url"],
		input[type="password"],
		input[type="search"],
		input[type="number"],
		input[type="tel"],
		input[type="range"],
		input[type="date"],
		input[type="month"],
		input[type="week"],
		input[type="time"],
		input[type="datetime"],
		input[type="datetime-local"],
		input[type="color"],
		textarea,
		select { border-color: #666666;}
hr { background-color: #898989;}
td,
		th,
		blockquote,
		.lodestar-front-page article:not(.has-post-thumbnail),
		.jetpack-testimonial .entry-content,
		.widget ul li,
		.widget_product_categories ul li li,
		.single-product div.product .woocommerce-tabs .woocommerce-Tabs-panel,
		.single-product div.product .woocommerce-tabs ul.tabs li,
		.widget .tagcloud a:hover,
		.widget .tagcloud a:focus,
		.widget.widget_tag_cloud a:hover,
		.widget.widget_tag_cloud a:focus,
		.wp_widget_tag_cloud a:hover,
		.wp_widget_tag_cloud a:focus,
		.jetpack-social-navigation,
		.woocommerce-checkout-payment ul.payment_methods,
		.woocommerce-checkout-payment .form-row { border-color: #BBBBBB;}
.entry-content div.sharedaddy h3,
		.entry-content div.sharedaddy h3.sd-title,
		.entry-content div#jp-relatedposts h3.jp-relatedposts-headline { color: #555555;}
.main-navigation ul { background: #111111;}
body,
		.one-column .panel-content .wrap,
		.jetpack-social-navigation { background-color: #f1f1f1;}
.site-footer .widget-area { background-color: #E5E5E5;}
.site-footer .jetpack-social-navigation a { color: #f1f1f1;}
.single-product div.product .woocommerce-tabs ul.tabs li.active { border-bottom-color: #f1f1f1;}
body,
		a:hover,
		a:focus,
		a:active,
		.entry-title a,
		.entry-content h1,
		.entry-content h2,
		.entry-content h3,
		.entry-content h4,
		.entry-content h5,
		.entry-content h6,
		.project-terms a.current-type,
		.panel-content .entry-title,
		.entry-meta,
		.lodestar-intro .entry-content,
		.lodestar-panel .jetpack-testimonial .entry-header h2,
		.widget-area .widget.woocommerce ul.product_list_widget li > a.remove,
		table.cart .product-remove a { color: #2D2D2D;}
input[type="text"],
		input[type="email"],
		input[type="url"],
		input[type="password"],
		input[type="search"],
		input[type="number"],
		input[type="tel"],
		input[type="range"],
		input[type="date"],
		input[type="month"],
		input[type="week"],
		input[type="time"],
		input[type="datetime"],
		input[type="datetime-local"],
		input[type="color"],
		textarea { color: #4C4C4C;}
input[type="text"]:focus,
		input[type="email"]:focus,
		input[type="url"]:focus,
		input[type="password"]:focus,
		input[type="search"]:focus,
		input[type="number"]:focus,
		input[type="tel"]:focus,
		input[type="range"]:focus,
		input[type="date"]:focus,
		input[type="month"]:focus,
		input[type="week"]:focus,
		input[type="time"]:focus,
		input[type="datetime"]:focus,
		input[type="datetime-local"]:focus,
		input[type="color"]:focus,
		textarea:focus { color: #4C4C4C;}
.site-header,
		.header-top,
		.main-navigation ul ul ul,
		.main-navigation ul ul ul ul ul,
		.main-navigation ul ul ul ul ul ul ul,
		.main-navigation ul ul ul ul ul ul ul ul ul,
		.main-navigation ul ul ul ul ul ul ul ul ul ul ul,
		.main-navigation ul ul a:hover,
		.main-navigation ul ul a:focus,
		.main-navigation ul ul li:hover,
		.main-navigation ul ul li:focus,
		.main-navigation ul ul ul ul a:hover,
		.main-navigation ul ul ul ul a:focus,
		.main-navigation ul ul ul ul li:hover,
		.main-navigation ul ul ul ul li:focus,
		.main-navigation ul ul ul ul ul ul a:hover,
		.main-navigation ul ul ul ul ul ul a:focus,
		.main-navigation ul ul ul ul ul ul li:hover,
		.main-navigation ul ul ul ul ul ul li:focus,
		.main-navigation ul ul ul ul ul ul ul ul a:hover,
		.main-navigation ul ul ul ul ul ul ul ul a:focus,
		.main-navigation ul ul ul ul ul ul ul ul li:hover,
		.main-navigation ul ul ul ul ul ul ul ul li:focus,
		.main-navigation ul ul ul ul ul ul ul ul ul ul a:hover,
		.main-navigation ul ul ul ul ul ul ul ul ul ul a:focus,
		.main-navigation ul ul ul ul ul ul ul ul ul ul li:hover,
		.main-navigation ul ul ul ul ul ul ul ul ul ul li:focus,
		.site-info,
		button,
		button:hover,
		button:focus,
		input[type="button"],
		input[type="button"]:hover,
		input[type="button"]:focus,
		input[type="reset"],
		input[type="reset"]:hover,
		input[type="reset"]:focus,
		input[type="submit"],
		input[type="submit"]:hover,
		input[type="submit"]:focus,
		#infinite-handle span button,
		#infinite-handle span button:hover,
		#infinite-handle span button:focus { background-color: #4c4c4c;}
.main-navigation li:hover,
		.main-navigation li:focus,
		.main-navigation a:hover,
		.main-navigation a:focus,
		.main-navigation ul ul,
		.main-navigation ul ul ul ul,
		.main-navigation ul ul ul ul ul ul,
		.main-navigation ul ul ul ul ul ul ul ul,
		.main-navigation ul ul ul ul ul ul ul ul ul ul,
		.main-navigation ul ul ul a:hover,
		.main-navigation ul ul ul a:focus,
		.main-navigation ul ul ul li:hover,
		.main-navigation ul ul ul li:focus,
		.main-navigation ul ul ul ul ul a:hover,
		.main-navigation ul ul ul ul ul a:focus,
		.main-navigation ul ul ul ul ul li:hover,
		.main-navigation ul ul ul ul ul li:focus,
		.main-navigation ul ul ul ul ul ul ul a:hover,
		.main-navigation ul ul ul ul ul ul ul a:focus,
		.main-navigation ul ul ul ul ul ul ul li:hover,
		.main-navigation ul ul ul ul ul ul ul li:focus,
		.main-navigation ul ul ul ul ul ul ul ul ul a:hover,
		.main-navigation ul ul ul ul ul ul ul ul ul a:focus,
		.main-navigation ul ul ul ul ul ul ul ul ul li:hover,
		.main-navigation ul ul ul ul ul ul ul ul ul li:focus,
		.main-navigation ul ul ul ul ul ul ul ul ul ul ul a:hover,
		.main-navigation ul ul ul ul ul ul ul ul ul ul ul a:focus,
		.main-navigation ul ul ul ul ul ul ul ul ul ul ul li:hover,
		.main-navigation ul ul ul ul ul ul ul ul ul ul ul li:focus,
		.main-navigation ul,
		.main-navigation ul li.current_page_item > a,
		.main-navigation ul li.current-menu-item > a,
		.main-navigation ul li.current_page_ancestor > a { background-color: #686868;}
.star-rating span:before,
			span.price,
			p.price,
			span.price ins,
			p.price ins,
			.widget_layered_nav_filters ul li a:before { color: #4C4C4C;}
.woocommerce-account .woocommerce-MyAccount-navigation ul li.is-active a,
			.woocommerce-page .button,
			.woocommerce-page .button:visited,
			.woocommerce-page .hover,
			.woocommerce-page .button:hover,
			.site-header-cart .widget_shopping_cart .woocommerce-mini-cart__buttons .button,
			.site-header-cart .widget_shopping_cart .woocommerce-mini-cart__buttons .button:hover,
			.site-header-cart .button,
			.site-header-cart .button:visited { background-color: #4c4c4c;}
.site-header-cart .widget_shopping_cart { background-color: #686868;}
.onsale,
			table.cart .product-remove a:hover,
			.woocommerce-message:before,
			.woocommerce-info:before,
			.woocommerce-error:before,
			.woocommerce-noreviews:before,
			p.no-comments:before,
			.single-product div.product .woocommerce-product-gallery .woocommerce-product-gallery__trigger:before { background-color: #4C4C4C;}
.woocommerce-message,
		.woocommerce-info,
		.woocommerce-error,
		.woocommerce-noreviews,
		p.no-comments { border-color: #4C4C4C;}
a,
		a:visited,
		.entry-title a:hover,
		.entry-title a:focus { color: #C61E3A;}
button,
		button:hover,
		button:focus,
		input[type="button"],
		input[type="button"]:hover,
		input[type="button"]:focus,
		input[type="reset"],
		input[type="reset"]:hover,
		input[type="reset"]:focus,
		input[type="submit"],
		input[type="submit"]:hover,
		input[type="submit"]:focus,
		#infinite-handle span button,
		#infinite-handle span button:hover,
		#infinite-handle span button:focus { color: #F0B7BF;}
.site-footer .jetpack-social-navigation a,
		.site-footer .jetpack-social-navigation a:hover,
		.site-footer .jetpack-social-navigation a:focus { background-color: #C61E3A;}
.widget_price_filter .ui-slider .ui-slider-range,
		.widget_price_filter .ui-slider .ui-slider-handle { background-color: #C61E3A;}
.woocommerce-page .button,
		.site-header-cart .widget_shopping_cart .woocommerce-mini-cart__buttons .button,
		.site-header-cart .widget_shopping_cart .woocommerce-mini-cart__buttons .button:hover { color: #F0B7BF;}
</style>
<link rel="icon" href="https://smsagent.files.wordpress.com/2017/05/cropped-smsagent-11.png?w=32" sizes="32x32">
<link rel="icon" href="https://smsagent.files.wordpress.com/2017/05/cropped-smsagent-11.png?w=192" sizes="192x192">
<link rel="apple-touch-icon" href="https://smsagent.files.wordpress.com/2017/05/cropped-smsagent-11.png?w=180">
<meta name="msapplication-TileImage" content="https://smsagent.files.wordpress.com/2017/05/cropped-smsagent-11.png?w=270"><link rel="stylesheet" href="./PowerShell Tip! Create Background Jobs with a Custom Class_files/css(1)" media="all">
<link rel="stylesheet" type="text/css" href="./PowerShell Tip! Create Background Jobs with a Custom Class_files/shCore.css"><link rel="stylesheet" type="text/css" href="./PowerShell Tip! Create Background Jobs with a Custom Class_files/shThemeDefault.css"><link rel="stylesheet" type="text/css" id="gravatar-card-css" href="./PowerShell Tip! Create Background Jobs with a Custom Class_files/hovercard.min.css"><link rel="stylesheet" type="text/css" id="gravatar-card-services-css" href="./PowerShell Tip! Create Background Jobs with a Custom Class_files/services.min.css"><link href="./PowerShell Tip! Create Background Jobs with a Custom Class_files/actionbar.css" type="text/css" rel="stylesheet"></head>

<body class="post-template-default single single-post postid-3388 single-format-standard custom-background wp-embed-responsive customizer-styles-applied lodestar-footer-image highlander-enabled highlander-light">
<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/#content">Skip to content</a>

	<header id="masthead" class="site-header" role="banner">

		<div class="header-top site-header-fixed">
			<div class="wrap">
				<nav id="site-navigation" class="main-navigation" role="navigation" aria-label="Top Menu">
	<button class="menu-toggle" aria-controls="top-menu" aria-expanded="false">Menu</button>
	<div class="menu-yo-container"><ul id="top-menu" class="menu nav-menu" aria-expanded="false"><li id="menu-item-5844" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-5844"><a href="https://smsagent.blog/">smsagent.blog</a></li>
<li id="menu-item-5855" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-5855"><a href="https://smsagent.blog/blog-posts/">Blog Posts</a></li>
<li id="menu-item-5847" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5847"><a href="https://docs.smsagent.blog/">docs.smsagent.blog</a></li>
<li id="menu-item-5848" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5848"><a href="https://github.com/SMSAgentSoftware">Github</a></li>
<li id="menu-item-5849" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5849"><a href="https://gist.github.com/SMSAgentSoftware">Gists</a></li>
<li id="menu-item-5850" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5850"><a href="https://www.youtube.com/channel/UC0ArVRczMzls36uPYw00nrg">YouTube</a></li>
</ul></div></nav><!-- #site-navigation -->
											</div>
		</div><!-- .header-top -->

		
<div class="custom-header" style="margin-top: auto;">
	
			<div class="custom-header-image" style="background-image: url(&quot;https://smsagent.files.wordpress.com/2021/08/cropped-img_3929.jpg&quot;); margin-top: 88px;">
				<div class="site-branding">
	<div class="wrap">

		
					<p class="site-title"><a href="https://smsagent.blog/" rel="home"></a></p>
		
		
	</div><!-- .wrap -->
</div><!-- .site-branding -->
			</div>

		
</div><!-- .custom-header -->

	</header>

	<div id="content" class="site-content">

<div class="wrap">
	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

			
<article id="post-3388" class="post-3388 post type-post status-publish format-standard hentry category-powershell tag-powershell-background-job tag-powershell-custom-class tag-powershell-job tag-powershell-multi-threading tag-powershell-multithreading tag-powershell-runspace">
	
	<header class="entry-header">
		<h1 class="entry-title">PowerShell Tip! Create Background Jobs with a Custom&nbsp;Class</h1>				<div class="entry-meta">
					<span class="posted-on">Posted on <a href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/" rel="bookmark"><time class="entry-date published updated" datetime="2017-02-17T17:09:55+00:00">February 17, 2017</time></a></span><span class="byline"> <span class="byline-prefix">by</span> <span class="author vcard"><a class="url fn n" href="https://smsagent.blog/author/trevandju/">Trevor Jones</a></span></span><span class="cat-links"> <span class="cat-prefix">in</span> <a href="https://smsagent.blog/category/powershell/" rel="category tag">Powershell</a></span>				</div><!-- .entry-meta -->

				</header>
	<div class="entry-content">
		<p>PowerShell 5 introduced the capability to create custom classes. Classes are a convenient way to create an object with your own custom definition, and can include properties and methods. There could be many potential use cases for such a custom class, but here’s one that is handy: background jobs. PowerShell comes with some cmdlets for running jobs in the background, such as Start-Job, or the -AsJob parameter, but if you’ve ever worked directly with runspaces in PowerShell, you know they perform better than jobs in a multi-threading scenario.</p>
<p>I put together a quick custom class that can be used in a similar way to the PowerShell job cmdlets, but by creating and managing its own PowerShell instance and runspace.</p>
<p>First off, here’s the class (PowerShell 5 or greater required)</p>
<div><div id="highlighter_332159" class="syntaxhighlighter  powershell"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="powershell plain">class BackgroundJob</code></div><div class="line number2 index1 alt1"><code class="powershell plain">{</code></div><div class="line number3 index2 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell comments"># Properties</code></div><div class="line number4 index3 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">hidden </code><code class="powershell variable">$PowerShell</code> <code class="powershell plain">= </code><code class="powershell constants">[powershell]</code><code class="powershell plain">::Create()</code></div><div class="line number5 index4 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">hidden </code><code class="powershell variable">$Handle</code> <code class="powershell plain">= </code><code class="powershell variable">$null</code></div><div class="line number6 index5 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">hidden </code><code class="powershell variable">$Runspace</code> <code class="powershell plain">= </code><code class="powershell variable">$null</code></div><div class="line number7 index6 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$Result</code> <code class="powershell plain">= </code><code class="powershell variable">$null</code></div><div class="line number8 index7 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$RunspaceID</code> <code class="powershell plain">= </code><code class="powershell variable">$This</code><code class="powershell plain">.PowerShell.Runspace.ID</code></div><div class="line number9 index8 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$PSInstance</code> <code class="powershell plain">= </code><code class="powershell variable">$This</code><code class="powershell plain">.PowerShell</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell comments"># Constructor (just code block)</code></div><div class="line number12 index11 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">BackgroundJob (</code><code class="powershell constants">[scriptblock]</code><code class="powershell variable">$Code</code><code class="powershell plain">)</code></div><div class="line number13 index12 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">{</code></div><div class="line number14 index13 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$This</code><code class="powershell plain">.PowerShell.AddScript(</code><code class="powershell variable">$Code</code><code class="powershell plain">)</code></div><div class="line number15 index14 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">}</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell comments"># Constructor (code block + arguments)</code></div><div class="line number18 index17 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">BackgroundJob (</code><code class="powershell constants">[scriptblock]</code><code class="powershell variable">$Code</code><code class="powershell plain">,</code><code class="powershell variable">$Arguments</code><code class="powershell plain">)</code></div><div class="line number19 index18 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">{</code></div><div class="line number20 index19 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$This</code><code class="powershell plain">.PowerShell.AddScript(</code><code class="powershell variable">$Code</code><code class="powershell plain">)</code></div><div class="line number21 index20 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell keyword">foreach</code> <code class="powershell plain">(</code><code class="powershell variable">$Argument</code> <code class="powershell keyword">in</code> <code class="powershell variable">$Arguments</code><code class="powershell plain">)</code></div><div class="line number22 index21 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">{</code></div><div class="line number23 index22 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$This</code><code class="powershell plain">.PowerShell.AddArgument(</code><code class="powershell variable">$Argument</code><code class="powershell plain">)</code></div><div class="line number24 index23 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">}</code></div><div class="line number25 index24 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">}</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell comments"># Constructor (code block + arguments + functions)</code></div><div class="line number28 index27 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">BackgroundJob (</code><code class="powershell constants">[scriptblock]</code><code class="powershell variable">$Code</code><code class="powershell plain">,</code><code class="powershell variable">$Arguments</code><code class="powershell plain">,</code><code class="powershell variable">$Functions</code><code class="powershell plain">)</code></div><div class="line number29 index28 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">{</code></div><div class="line number30 index29 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$InitialSessionState</code> <code class="powershell plain">= </code><code class="powershell constants">[System.Management.Automation.Runspaces.InitialSessionState]</code><code class="powershell plain">::CreateDefault()</code></div><div class="line number31 index30 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$Scope</code> <code class="powershell plain">= </code><code class="powershell constants">[System.Management.Automation.ScopedItemOptions]</code><code class="powershell plain">::AllScope</code></div><div class="line number32 index31 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell keyword">foreach</code> <code class="powershell plain">(</code><code class="powershell variable">$Function</code> <code class="powershell keyword">in</code> <code class="powershell variable">$Functions</code><code class="powershell plain">)</code></div><div class="line number33 index32 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">{</code></div><div class="line number34 index33 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$FunctionName</code> <code class="powershell plain">= </code><code class="powershell variable">$Function</code><code class="powershell plain">.Split(</code><code class="powershell string single">'\'</code><code class="powershell plain">)[1]</code></div><div class="line number35 index34 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$FunctionDefinition</code> <code class="powershell plain">= </code><code class="powershell functions">Get-Content</code> <code class="powershell variable">$Function</code> <code class="powershell color1">-ErrorAction</code> <code class="powershell plain">Stop</code></div><div class="line number36 index35 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$SessionStateFunction</code> <code class="powershell plain">= </code><code class="powershell functions">New-Object</code> <code class="powershell color1">-TypeName</code> <code class="powershell plain">System.Management.Automation.Runspaces.SessionStateFunctionEntry</code> <code class="powershell color1">-ArgumentList</code> <code class="powershell variable">$FunctionName</code><code class="powershell plain">, </code><code class="powershell variable">$FunctionDefinition</code><code class="powershell plain">, </code><code class="powershell variable">$Scope</code><code class="powershell plain">, </code><code class="powershell variable">$null</code></div><div class="line number37 index36 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$InitialSessionState</code><code class="powershell plain">.Commands.Add(</code><code class="powershell variable">$SessionStateFunction</code><code class="powershell plain">)</code></div><div class="line number38 index37 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">}</code></div><div class="line number39 index38 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$This</code><code class="powershell plain">.Runspace = </code><code class="powershell constants">[runspacefactory]</code><code class="powershell plain">::CreateRunspace(</code><code class="powershell variable">$InitialSessionState</code><code class="powershell plain">)</code></div><div class="line number40 index39 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$This</code><code class="powershell plain">.PowerShell.Runspace = </code><code class="powershell variable">$This</code><code class="powershell plain">.Runspace</code></div><div class="line number41 index40 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$This</code><code class="powershell plain">.Runspace.Open()</code></div><div class="line number42 index41 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$This</code><code class="powershell plain">.PowerShell.AddScript(</code><code class="powershell variable">$Code</code><code class="powershell plain">)</code></div><div class="line number43 index42 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell keyword">foreach</code> <code class="powershell plain">(</code><code class="powershell variable">$Argument</code> <code class="powershell keyword">in</code> <code class="powershell variable">$Arguments</code><code class="powershell plain">)</code></div><div class="line number44 index43 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">{</code></div><div class="line number45 index44 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$This</code><code class="powershell plain">.PowerShell.AddArgument(</code><code class="powershell variable">$Argument</code><code class="powershell plain">)</code></div><div class="line number46 index45 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">}</code></div><div class="line number47 index46 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">}</code></div><div class="line number48 index47 alt1">&nbsp;</div><div class="line number49 index48 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell comments"># Start Method</code></div><div class="line number50 index49 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">Start()</code></div><div class="line number51 index50 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">{</code></div><div class="line number52 index51 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$THis</code><code class="powershell plain">.Handle = </code><code class="powershell variable">$This</code><code class="powershell plain">.PowerShell.BeginInvoke()</code></div><div class="line number53 index52 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">}</code></div><div class="line number54 index53 alt1">&nbsp;</div><div class="line number55 index54 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell comments"># Stop Method</code></div><div class="line number56 index55 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">Stop()</code></div><div class="line number57 index56 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">{</code></div><div class="line number58 index57 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$This</code><code class="powershell plain">.PowerShell.Stop()</code></div><div class="line number59 index58 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">}</code></div><div class="line number60 index59 alt1">&nbsp;</div><div class="line number61 index60 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell comments"># Receive Method</code></div><div class="line number62 index61 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell constants">[object]</code><code class="powershell plain">Receive()</code></div><div class="line number63 index62 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">{</code></div><div class="line number64 index63 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$This</code><code class="powershell plain">.Result = </code><code class="powershell variable">$This</code><code class="powershell plain">.PowerShell.EndInvoke(</code><code class="powershell variable">$This</code><code class="powershell plain">.Handle)</code></div><div class="line number65 index64 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell keyword">return</code> <code class="powershell variable">$This</code><code class="powershell plain">.Result</code></div><div class="line number66 index65 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">}</code></div><div class="line number67 index66 alt2">&nbsp;</div><div class="line number68 index67 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell comments"># Remove Method</code></div><div class="line number69 index68 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">Remove()</code></div><div class="line number70 index69 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">{</code></div><div class="line number71 index70 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$This</code><code class="powershell plain">.PowerShell.Dispose()</code></div><div class="line number72 index71 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell keyword">If</code> <code class="powershell plain">(</code><code class="powershell variable">$This</code><code class="powershell plain">.Runspace)</code></div><div class="line number73 index72 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">{</code></div><div class="line number74 index73 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$This</code><code class="powershell plain">.Runspace.Dispose()</code></div><div class="line number75 index74 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">}</code></div><div class="line number76 index75 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">}</code></div><div class="line number77 index76 alt2">&nbsp;</div><div class="line number78 index77 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell comments"># Get Status Method</code></div><div class="line number79 index78 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell constants">[object]</code><code class="powershell plain">GetStatus()</code></div><div class="line number80 index79 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">{</code></div><div class="line number81 index80 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell keyword">return</code> <code class="powershell variable">$This</code><code class="powershell plain">.PowerShell.InvocationStateInfo</code></div><div class="line number82 index81 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">}</code></div><div class="line number83 index82 alt2"><code class="powershell plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>To create an object with this class definition, we need to instantiate it using a constructor. There are a couple of constructor overloads to give us some different options when we create the object.</p>
<p>The simplest way it to just pass a block of code you want to run in the background job:</p>
<div><div id="highlighter_993801" class="syntaxhighlighter  powershell"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="powershell variable">$Code</code> <code class="powershell plain">= {</code></div><div class="line number2 index1 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell functions">Test-Connection</code> <code class="powershell plain">10.25.24.27</code> <code class="powershell color1">-Count</code> <code class="powershell plain">4</code></div><div class="line number3 index2 alt2"><code class="powershell plain">}</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="powershell variable">$Job</code> <code class="powershell plain">= </code><code class="powershell constants">[BackgroundJob]</code><code class="powershell plain">::New(</code><code class="powershell variable">$Code</code><code class="powershell plain">)</code></div></div></td></tr></tbody></table></div></div>
<p>To start the job, simply call the Start() method:</p>
<div><div id="highlighter_692405" class="syntaxhighlighter  powershell"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="powershell variable">$Job</code><code class="powershell plain">.Start()</code></div></div></td></tr></tbody></table></div></div>
<p>To check the status of the job, we can call the GetStatus() method:</p>
<div><div id="highlighter_419345" class="syntaxhighlighter  powershell"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="powershell variable">$Job</code><code class="powershell plain">.GetStatus()</code></div></div></td></tr></tbody></table></div></div>
<figure data-shortcode="caption" id="attachment_3420" aria-describedby="caption-attachment-3420" style="width: 296px" class="wp-caption aligncenter"><img data-attachment-id="3420" data-permalink="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/pic/" data-orig-file="https://smsagent.files.wordpress.com/2017/02/pic.png" data-orig-size="296,93" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="pic" data-image-description="" data-image-caption="" data-medium-file="https://smsagent.files.wordpress.com/2017/02/pic.png?w=296" data-large-file="https://smsagent.files.wordpress.com/2017/02/pic.png?w=296" class=" size-full wp-image-3420 aligncenter" src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/pic.png" alt="pic" srcset="https://smsagent.files.wordpress.com/2017/02/pic.png 296w, https://smsagent.files.wordpress.com/2017/02/pic.png?w=150 150w" sizes="(max-width: 296px) 100vw, 296px"><figcaption id="caption-attachment-3420" class="wp-caption-text">Check the job status</figcaption></figure>
<p>When the job has completed, we can receive any results outputted by the code:</p>
<div><div id="highlighter_869537" class="syntaxhighlighter  powershell"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="powershell variable">$Job</code><code class="powershell plain">.Receive()</code></div></div></td></tr></tbody></table></div></div>
<figure data-shortcode="caption" id="attachment_3426" aria-describedby="caption-attachment-3426" style="width: 786px" class="wp-caption aligncenter"><a href="https://smsagent.files.wordpress.com/2017/02/receive.png" target="_blank"><img data-attachment-id="3426" data-permalink="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/receive/" data-orig-file="https://smsagent.files.wordpress.com/2017/02/receive.png" data-orig-size="786,132" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="receive" data-image-description="" data-image-caption="" data-medium-file="https://smsagent.files.wordpress.com/2017/02/receive.png?w=300" data-large-file="https://smsagent.files.wordpress.com/2017/02/receive.png?w=700" class=" size-full wp-image-3426 aligncenter" src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/receive.png" alt="receive" srcset="https://smsagent.files.wordpress.com/2017/02/receive.png?w=700 700w, https://smsagent.files.wordpress.com/2017/02/receive.png?w=150 150w, https://smsagent.files.wordpress.com/2017/02/receive.png?w=300 300w, https://smsagent.files.wordpress.com/2017/02/receive.png?w=768 768w, https://smsagent.files.wordpress.com/2017/02/receive.png 786w" sizes="(max-width: 700px) 100vw, 700px"></a><figcaption id="caption-attachment-3426" class="wp-caption-text">Receive the job results</figcaption></figure>
<p>Then we close off the job. This is important to properly dispose of the PowerShell instance.</p>
<div><div id="highlighter_104399" class="syntaxhighlighter  powershell"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="powershell variable">$Job</code><code class="powershell plain">.Remove()</code></div></div></td></tr></tbody></table></div></div>
<p>If the job is running too long, we can close the pipeline to stop the job:</p>
<div><div id="highlighter_920901" class="syntaxhighlighter  powershell"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="powershell variable">$Job</code><code class="powershell plain">.Stop()</code></div></div></td></tr></tbody></table></div></div>
<p>The PowerShell instance that we created gets added to the object as the <strong>PSInstance</strong> property, so we can explore it further if we want. Here I am viewing the command that was run in the job:</p>
<div><div id="highlighter_861180" class="syntaxhighlighter  powershell"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="powershell variable">$Job</code><code class="powershell plain">.PSInstance.Commands.Commands.CommandText</code></div></div></td></tr></tbody></table></div></div>
<figure data-shortcode="caption" id="attachment_3439" aria-describedby="caption-attachment-3439" style="width: 507px" class="wp-caption aligncenter"><a href="https://smsagent.files.wordpress.com/2017/02/job.png" target="_blank"><img data-attachment-id="3439" data-permalink="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/job/" data-orig-file="https://smsagent.files.wordpress.com/2017/02/job.png" data-orig-size="507,74" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="job" data-image-description="" data-image-caption="" data-medium-file="https://smsagent.files.wordpress.com/2017/02/job.png?w=300" data-large-file="https://smsagent.files.wordpress.com/2017/02/job.png?w=507" class=" size-full wp-image-3439 aligncenter" src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/job.png" alt="job" srcset="https://smsagent.files.wordpress.com/2017/02/job.png 507w, https://smsagent.files.wordpress.com/2017/02/job.png?w=150 150w, https://smsagent.files.wordpress.com/2017/02/job.png?w=300 300w" sizes="(max-width: 507px) 100vw, 507px"></a><figcaption id="caption-attachment-3439" class="wp-caption-text">Browse the background PowerShell Instance</figcaption></figure>
<p>Another constructor allows us to pass arguments for the code when we create the object. Since the background job is running in a separate thread, it does not have access to the variables in our main thread, so we need to pass them. Remember to add a <strong>Param()</strong> block to your code when passing variables.</p>
<div><div id="highlighter_600558" class="syntaxhighlighter  powershell"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="powershell variable">$ComputerName</code> <code class="powershell plain">= </code><code class="powershell string">"PC001"</code></div><div class="line number2 index1 alt1"><code class="powershell variable">$Code</code> <code class="powershell plain">= {</code></div><div class="line number3 index2 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell keyword">Param</code><code class="powershell plain">(</code><code class="powershell variable">$ComputerName</code><code class="powershell plain">)</code></div><div class="line number4 index3 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell functions">Test-Connection</code> <code class="powershell variable">$ComputerName</code> <code class="powershell color1">-Count</code> <code class="powershell plain">4</code></div><div class="line number5 index4 alt2"><code class="powershell plain">}</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="powershell variable">$Job</code> <code class="powershell plain">= </code><code class="powershell constants">[BackgroundJob]</code><code class="powershell plain">::New(</code><code class="powershell variable">$Code</code><code class="powershell plain">,</code><code class="powershell variable">$ComputerName</code><code class="powershell plain">)</code></div></div></td></tr></tbody></table></div></div>
<p>We can also pass multiple variables in an array like this, but in the Param() block remember to keep them in the same order you pass them.</p>
<div><div id="highlighter_684940" class="syntaxhighlighter  powershell"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="powershell variable">$ComputerName</code> <code class="powershell plain">= </code><code class="powershell string">"PC001"</code></div><div class="line number2 index1 alt1"><code class="powershell variable">$Count</code> <code class="powershell plain">= 10</code></div><div class="line number3 index2 alt2"><code class="powershell variable">$Code</code> <code class="powershell plain">= {</code></div><div class="line number4 index3 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell keyword">Param</code><code class="powershell plain">(</code><code class="powershell variable">$ComputerName</code><code class="powershell plain">,</code><code class="powershell variable">$Count</code><code class="powershell plain">)</code></div><div class="line number5 index4 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell functions">Test-Connection</code> <code class="powershell variable">$ComputerName</code> <code class="powershell color1">-Count</code> <code class="powershell variable">$Count</code></div><div class="line number6 index5 alt1"><code class="powershell plain">}</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="powershell variable">$Job</code> <code class="powershell plain">= </code><code class="powershell constants">[BackgroundJob]</code><code class="powershell plain">::New(</code><code class="powershell variable">$Code</code><code class="powershell plain">,@(</code><code class="powershell variable">$ComputerName</code><code class="powershell plain">,</code><code class="powershell variable">$Count</code><code class="powershell plain">))</code></div></div></td></tr></tbody></table></div></div>
<p>Finally, we can also pass custom functions to the background job:</p>
<div><div id="highlighter_54506" class="syntaxhighlighter  powershell"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="powershell keyword">Function</code> <code class="powershell functions">Ping-Computers</code> <code class="powershell plain">{</code></div><div class="line number2 index1 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell keyword">Param</code><code class="powershell plain">(</code><code class="powershell constants">[String[]]</code><code class="powershell variable">$ComputerName</code><code class="powershell plain">, </code><code class="powershell variable">$Count</code><code class="powershell plain">)</code></div><div class="line number3 index2 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$ComputerName</code> <code class="powershell plain">| </code><code class="powershell keyword">foreach</code> <code class="powershell plain">{</code></div><div class="line number4 index3 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell functions">Test-Connection</code> <code class="powershell color1">-ComputerName</code> <code class="powershell variable">$_</code> <code class="powershell color1">-Count</code> <code class="powershell variable">$Count</code></div><div class="line number5 index4 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">}</code></div><div class="line number6 index5 alt1"><code class="powershell plain">}</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="powershell variable">$ComputerName</code> <code class="powershell plain">= </code><code class="powershell string">"PC001"</code><code class="powershell plain">,</code><code class="powershell string">"PC002"</code><code class="powershell plain">,</code><code class="powershell string">"PC003"</code></div><div class="line number9 index8 alt2"><code class="powershell variable">$Count</code> <code class="powershell plain">= 10</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="powershell variable">$Code</code> <code class="powershell plain">= {</code></div><div class="line number12 index11 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell keyword">Param</code><code class="powershell plain">(</code><code class="powershell variable">$ComputerName</code><code class="powershell plain">,</code><code class="powershell variable">$Count</code><code class="powershell plain">)</code></div><div class="line number13 index12 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell functions">Ping-Computers</code> <code class="powershell color1">-ComputerName</code> <code class="powershell variable">$ComputerName</code> <code class="powershell color1">-Count</code> <code class="powershell variable">$Count</code></div><div class="line number14 index13 alt1"><code class="powershell plain">}</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="powershell variable">$Job</code> <code class="powershell plain">= </code><code class="powershell constants">[BackgroundJob]</code><code class="powershell plain">::New(</code><code class="powershell variable">$Code</code><code class="powershell plain">,@(</code><code class="powershell variable">$ComputerName</code><code class="powershell plain">,</code><code class="powershell variable">$Count</code><code class="powershell plain">),</code><code class="powershell string">"Function:\Ping-Computers"</code><code class="powershell plain">)</code></div></div></td></tr></tbody></table></div></div>
<p>There are many possibilities for customising this class further, but using a custom class like this is a convenient way to spin up a job in the background, or to add some multi-threading capability to a script.</p>
<p>Here’s a simple example of multi-threading. First we add jobs to a hash table, then we start each job. Next we wait until each job is completed, and then return the output. The whole process takes much less time than running the commands synchronously (one after another).</p>
<div><div id="highlighter_552376" class="syntaxhighlighter  powershell"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="powershell comments"># Create multiple jobs</code></div><div class="line number2 index1 alt1"><code class="powershell variable">$Jobs</code> <code class="powershell plain">= @{</code></div><div class="line number3 index2 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">Job1 = </code><code class="powershell constants">[BackgroundJob]</code><code class="powershell plain">::New({</code><code class="powershell functions">Test-Connection</code> <code class="powershell color1">-ComputerName</code> <code class="powershell plain">10.20.17.129</code> <code class="powershell color1">-Count</code> <code class="powershell plain">5})</code></div><div class="line number4 index3 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">Job2 = </code><code class="powershell constants">[BackgroundJob]</code><code class="powershell plain">::New({</code><code class="powershell functions">Test-Connection</code> <code class="powershell color1">-ComputerName</code> <code class="powershell plain">10.1.16.86</code> <code class="powershell color1">-Count</code> <code class="powershell plain">5})</code></div><div class="line number5 index4 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">Job3 = </code><code class="powershell constants">[BackgroundJob]</code><code class="powershell plain">::New({</code><code class="powershell functions">Test-Connection</code> <code class="powershell color1">-ComputerName</code> <code class="powershell plain">10.21.17.216</code> <code class="powershell color1">-Count</code> <code class="powershell plain">5})</code></div><div class="line number6 index5 alt1"><code class="powershell plain">}</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="powershell comments"># Start each job</code></div><div class="line number9 index8 alt2"><code class="powershell variable">$Jobs</code><code class="powershell plain">.GetEnumerator() | </code><code class="powershell keyword">foreach</code> <code class="powershell plain">{</code></div><div class="line number10 index9 alt1"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell variable">$_</code><code class="powershell plain">.Value.Start()</code></div><div class="line number11 index10 alt2"><code class="powershell spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="powershell plain">}</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="powershell comments"># Wait for the results</code></div><div class="line number14 index13 alt1"><code class="powershell keyword">Do</code> <code class="powershell plain">{}</code></div><div class="line number15 index14 alt2"><code class="powershell keyword">Until</code> <code class="powershell plain">((</code><code class="powershell variable">$Jobs</code><code class="powershell plain">.GetEnumerator() | </code><code class="powershell keyword">foreach</code> <code class="powershell plain">{</code><code class="powershell variable">$_</code><code class="powershell plain">.Value.GetStatus().State}) </code><code class="powershell operator value">-notcontains</code> <code class="powershell string">"Running"</code><code class="powershell plain">)</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="powershell comments"># Output the results</code></div><div class="line number18 index17 alt1"><code class="powershell variable">$Jobs</code><code class="powershell plain">.GetEnumerator() | </code><code class="powershell keyword">foreach</code> <code class="powershell plain">{</code><code class="powershell variable">$_</code><code class="powershell plain">.Value.Receive()}</code></div></div></td></tr></tbody></table></div></div>
<figure data-shortcode="caption" id="attachment_3464" aria-describedby="caption-attachment-3464" style="width: 766px" class="wp-caption aligncenter"><a href="https://smsagent.files.wordpress.com/2017/02/multi.png" target="_blank"><img data-attachment-id="3464" data-permalink="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/multi/" data-orig-file="https://smsagent.files.wordpress.com/2017/02/multi.png" data-orig-size="766,250" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="multi" data-image-description="" data-image-caption="" data-medium-file="https://smsagent.files.wordpress.com/2017/02/multi.png?w=300" data-large-file="https://smsagent.files.wordpress.com/2017/02/multi.png?w=700" class=" size-full wp-image-3464 aligncenter" src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/multi.png" alt="multi" srcset="https://smsagent.files.wordpress.com/2017/02/multi.png?w=700 700w, https://smsagent.files.wordpress.com/2017/02/multi.png?w=150 150w, https://smsagent.files.wordpress.com/2017/02/multi.png?w=300 300w, https://smsagent.files.wordpress.com/2017/02/multi.png 766w" sizes="(max-width: 700px) 100vw, 700px"></a><figcaption id="caption-attachment-3464" class="wp-caption-text">Multiple simultaneous jobs</figcaption></figure>
<p>The job result will be saved to the <strong>Result</strong> property after the <strong>Receive()</strong> method is called, so they are stored in the variable and can be retrieved later if needed.</p>
<p>You can also create a kind of class library, which you can import each time you run a PowerShell session, so that this custom class is always available to you, which I blogged about <a href="https://smsagent.wordpress.com/posh-5-custom-classes/creating-a-custom-class-library/" target="_blank">here</a>.</p>
<p>Good job, what!</p>
<div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul data-sharing-events-added="true"><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-3388" class="share-twitter sd-button share-icon" href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/?share=twitter&amp;nb=1" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-3388" class="share-facebook sd-button share-icon" href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/?share=facebook&amp;nb=1" target="_blank" title="Click to share on Facebook"><span>Facebook</span></a></li><li class="share-email share-service-visible"><a rel="nofollow noopener noreferrer" data-shared="" class="share-email sd-button share-icon" href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/?share=email&amp;nb=1" target="_blank" title="Click to email this to a friend"><span>Email</span></a></li><li class="share-print"><a rel="nofollow noopener noreferrer" data-shared="" class="share-print sd-button share-icon" href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/#print" target="_blank" title="Click to print"><span>Print</span></a></li><li class="share-linkedin"><a rel="nofollow noopener noreferrer" data-shared="sharing-linkedin-3388" class="share-linkedin sd-button share-icon" href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/?share=linkedin&amp;nb=1" target="_blank" title="Click to share on LinkedIn"><span>LinkedIn</span></a></li><li class="share-end"></li></ul></div></div></div><div class="sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-loaded" id="like-post-wrapper-63076196-3388-61374a819601d" data-src="//widgets.wp.com/likes/index.html?ver=20210818#blog_id=63076196&amp;post_id=3388&amp;origin=smsagent.wordpress.com&amp;obj_id=63076196-3388-61374a819601d&amp;domain=smsagent.blog" data-name="like-post-frame-63076196-3388-61374a819601d" data-title="Like or Reblog"><h3 class="sd-title">Like this:</h3><div class="likes-widget-placeholder post-likes-widget-placeholder" style="height: 55px; display: none;"><span class="button"><span>Like</span></span> <span class="loading">Loading...</span></div><iframe class="post-likes-widget jetpack-likes-widget" name="like-post-frame-63076196-3388-61374a819601d" src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/index.html" height="55px" width="100%" frameborder="0" title="Like or Reblog"></iframe><span class="sd-text-color"></span><a class="sd-link-color"></a></div>
<div id="jp-relatedposts" class="jp-relatedposts" style="display: block;">
	
<div class="jp-relatedposts-items jp-relatedposts-items-minimal jp-relatedposts-grid "><p class="jp-relatedposts-post jp-relatedposts-post0" data-post-id="743" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://smsagent.blog/2015/09/07/powershell-tip-utilizing-runspaces-for-responsive-wpf-gui-applications/" title="PowerShell Tip: Utilizing Runspaces for Responsive WPF GUI Applications" data-origin="3388" data-position="0">PowerShell Tip: Utilizing Runspaces for Responsive WPF GUI&nbsp;Applications</a></span><time class="jp-relatedposts-post-date" datetime="September 7, 2015" style="display: block;">September 7, 2015</time><span class="jp-relatedposts-post-context">In "Powershell"</span></p><p class="jp-relatedposts-post jp-relatedposts-post1" data-post-id="4370" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://smsagent.blog/2017/08/24/a-customisable-wpf-messagebox-for-powershell/" title="A Customisable WPF MessageBox for PowerShell" data-origin="3388" data-position="1">A Customisable WPF MessageBox for&nbsp;PowerShell</a></span><time class="jp-relatedposts-post-date" datetime="August 24, 2017" style="display: block;">August 24, 2017</time><span class="jp-relatedposts-post-context">In "Powershell"</span></p><p class="jp-relatedposts-post jp-relatedposts-post2" data-post-id="1719" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://smsagent.blog/2016/06/07/finding-the-lastlogon-date-from-all-domain-controllers-with-powershell/" title="Finding the ‘LastLogon’ Date from all Domain Controllers with PowerShell" data-origin="3388" data-position="2">Finding the ‘LastLogon’ Date from all Domain Controllers with&nbsp;PowerShell</a></span><time class="jp-relatedposts-post-date" datetime="June 7, 2016" style="display: block;">June 7, 2016</time><span class="jp-relatedposts-post-context">In "Active Directory"</span></p></div></div></div>	</div>
	<footer class="entry-footer">
		<span class="tags-links">Tagged <a href="https://smsagent.blog/tag/powershell-background-job/" rel="tag">powershell background job</a>, <a href="https://smsagent.blog/tag/powershell-custom-class/" rel="tag">powershell custom class</a>, <a href="https://smsagent.blog/tag/powershell-job/" rel="tag">powershell job</a>, <a href="https://smsagent.blog/tag/powershell-multi-threading/" rel="tag">powershell multi-threading</a>, <a href="https://smsagent.blog/tag/powershell-multithreading/" rel="tag">powershell multithreading</a>, <a href="https://smsagent.blog/tag/powershell-runspace/" rel="tag">powershell runspace</a></span>	</footer><!-- .entry-footer -->

		<div class="entry-author author-avatar-show">
				<div class="author-avatar">
			<span class="avatar-container"><img alt="" src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/82c90a29b90193456711fa794f5d849c.jpeg" class="avatar avatar-100 grav-hashed grav-hijack" height="100" width="100" id="grav-82c90a29b90193456711fa794f5d849c-0"></span>		</div><!-- .author-avatar -->
		
		<div class="author-heading">
			<h2 class="author-title">Published by <span class="author-name">Trevor Jones</span></h2>
		</div><!-- .author-heading -->

		<p class="author-bio">
						<a class="author-link" href="https://smsagent.blog/author/trevandju/" rel="author">
				View all posts by Trevor Jones			</a>
		</p><!-- .author-bio -->
	</div><!-- .entry-auhtor -->
</article><!-- #post-## -->

	<nav class="navigation post-navigation" role="navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://smsagent.blog/2017/02/06/automatically-set-sql-maxservermemory-on-cluster-failover-with-powershell/" rel="prev"><span class="nav-subtitle">Previous Post</span> <span class="nav-title">Automatically Set SQL MaxServerMemory on Cluster Failover with&nbsp;PowerShell</span></a></div><div class="nav-next"><a href="https://smsagent.blog/2017/02/21/export-backup-compliance-setting-scripts-with-powershell/" rel="next"><span class="nav-subtitle">Next Post</span> <span class="nav-title">Export / Backup Compliance Setting Scripts with&nbsp;PowerShell</span></a></div></div>
	</nav>
<div id="comments" class="comments-area">

			<h2 class="comments-title">
			2 thoughts on “<span>PowerShell Tip! Create Background Jobs with a Custom&nbsp;Class</span>”		</h2>

		
		<ol class="comment-list">
					<li id="comment-683" class="comment byuser comment-author-istrachan even thread-even depth-1 parent highlander-comment">
			<article id="div-comment-683" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<span class="avatar-container"><img alt="" src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/3521330a578fe7efbfe3043f7b9a3d6b.jpeg" class="avatar avatar-100 grav-hashed grav-hijack" height="100" width="100" id="grav-3521330a578fe7efbfe3043f7b9a3d6b-0"></span>						<b class="fn"><a href="http://pshirwin.wordpress.com/" rel="external nofollow ugc" class="url">Irwin Strachan</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/#comment-683"><time datetime="2017-02-19T08:16:16+00:00">February 19, 2017 at 8:16 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Love your code! </p>
<p>I’ve been struggling with Runspaces for quite some time now… This really helped break it down! Importing the function was an eye opener!!! </p>
<p>Thanks for sharing!!!</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/?replytocom=683#respond" data-commentid="683" data-postid="3388" data-belowelement="div-comment-683" data-respondelement="respond" data-replyto="Reply to Irwin Strachan" aria-label="Reply to Irwin Strachan">Reply</a></div>			</article><!-- .comment-body -->
		<ol class="children">
		<li id="comment-688" class="comment byuser comment-author-trevandju bypostauthor odd alt depth-2 highlander-comment">
			<article id="div-comment-688" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<span class="avatar-container"><img alt="" src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/82c90a29b90193456711fa794f5d849c.jpeg" class="avatar avatar-100 grav-hashed grav-hijack" height="100" width="100" id="grav-82c90a29b90193456711fa794f5d849c-1"></span>						<b class="fn"><a href="https://smsagent.wordpress.com/" rel="external nofollow ugc" class="url">Trevor Jones</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/#comment-688"><time datetime="2017-02-20T09:07:08+00:00">February 20, 2017 at 9:07 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>You’re welcome, glad it helps! I highly recommend the work of Boe Prox for learning runspaces: <a href="https://blogs.technet.microsoft.com/heyscriptingguy/2015/11/26/beginning-use-of-powershell-runspaces-part-1/" rel="nofollow ugc">https://blogs.technet.microsoft.com/heyscriptingguy/2015/11/26/beginning-use-of-powershell-runspaces-part-1/</a></p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/?replytocom=688#respond" data-commentid="688" data-postid="3388" data-belowelement="div-comment-688" data-respondelement="respond" data-replyto="Reply to Trevor Jones" aria-label="Reply to Trevor Jones">Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		</ol>

			<div id="respond" class="comment-respond js">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://smsagent.blog/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate=""><input type="hidden" id="highlander_comment_nonce" name="highlander_comment_nonce" value="b021042971"><input type="hidden" name="_wp_http_referer" value="/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/">
<input type="hidden" name="hc_post_as" id="hc_post_as" value="guest">

<div class="comment-form-field comment-textarea">
	
	<div id="comment-form-comment"><textarea aria-hidden="true" tabindex="-1" style="position: absolute; inset: -999px auto auto 0px; border: 0px; padding: 0px; box-sizing: content-box; overflow-wrap: break-word; overflow: hidden; transition: none 0s ease 0s; height: 0px !important; min-height: 0px !important; font-family: Arial, Helvetica, Tahoma, Verdana, sans-serif; font-size: 14px; font-weight: 400; font-style: normal; letter-spacing: 0px; text-transform: none; text-decoration: none solid rgba(0, 0, 0, 0.7); word-spacing: 0px; text-indent: 0px; line-height: 21px; width: 678px;" class="autosizejs "></textarea><textarea id="comment" name="comment" title="Enter your comment here..." placeholder="Enter your comment here..." style="height: 41px; overflow: hidden; overflow-wrap: break-word; resize: none;"></textarea></div>
</div>

<div id="comment-form-identity" style="display: none;">
	<div id="comment-form-nascar">
		<p>Fill in your details below or click an icon to log in:</p>
		<ul>
			<li class="selected" style="display:none;">
				<a href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/#comment-form-guest" id="postas-guest" class="nascar-signin-link" title="Login via Guest">
									</a>
			</li>
			<li>
				<a href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/#comment-form-load-service:WordPress.com" id="postas-wordpress" class="nascar-signin-link" title="Login via WordPress.com">
					<svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><rect x="0" fill="none" width="24" height="24"></rect><g><path fill="#0087be" d="M12.158 12.786l-2.698 7.84c.806.236 1.657.365 2.54.365 1.047 0 2.05-.18 2.986-.51-.024-.037-.046-.078-.065-.123l-2.762-7.57zM3.008 12c0 3.56 2.07 6.634 5.068 8.092L3.788 8.342c-.5 1.117-.78 2.354-.78 3.658zm15.06-.454c0-1.112-.398-1.88-.74-2.48-.456-.74-.883-1.368-.883-2.11 0-.825.627-1.595 1.51-1.595.04 0 .078.006.116.008-1.598-1.464-3.73-2.36-6.07-2.36-3.14 0-5.904 1.613-7.512 4.053.21.008.41.012.58.012.94 0 2.395-.114 2.395-.114.484-.028.54.684.057.74 0 0-.487.058-1.03.086l3.275 9.74 1.968-5.902-1.4-3.838c-.485-.028-.944-.085-.944-.085-.486-.03-.43-.77.056-.742 0 0 1.484.114 2.368.114.94 0 2.397-.114 2.397-.114.486-.028.543.684.058.74 0 0-.488.058-1.03.086l3.25 9.665.897-2.997c.456-1.17.684-2.137.684-2.907zm1.82-3.86c.04.286.06.593.06.924 0 .912-.17 1.938-.683 3.22l-2.746 7.94c2.672-1.558 4.47-4.454 4.47-7.77 0-1.564-.4-3.033-1.1-4.314zM12 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10z"></path></g></svg>				</a>
			</li>
			<li>
				<a href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/#comment-form-load-service:Twitter" id="postas-twitter" class="nascar-signin-link" title="Login via Twitter">
					<svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><rect x="0" fill="none" width="24" height="24"></rect><g><path fill="#1DA1F2" d="M22.23 5.924c-.736.326-1.527.547-2.357.646.847-.508 1.498-1.312 1.804-2.27-.793.47-1.67.812-2.606.996C18.325 4.498 17.258 4 16.078 4c-2.266 0-4.103 1.837-4.103 4.103 0 .322.036.635.106.935-3.41-.17-6.433-1.804-8.457-4.287-.353.607-.556 1.312-.556 2.064 0 1.424.724 2.68 1.825 3.415-.673-.022-1.305-.207-1.86-.514v.052c0 1.988 1.415 3.647 3.293 4.023-.344.095-.707.145-1.08.145-.265 0-.522-.026-.773-.074.522 1.63 2.038 2.817 3.833 2.85-1.404 1.1-3.174 1.757-5.096 1.757-.332 0-.66-.02-.98-.057 1.816 1.164 3.973 1.843 6.29 1.843 7.547 0 11.675-6.252 11.675-11.675 0-.178-.004-.355-.012-.53.802-.578 1.497-1.3 2.047-2.124z"></path></g></svg>				</a>
			</li>
			<li>
				<a href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/#comment-form-load-service:Facebook" id="postas-facebook" class="nascar-signin-link" title="Login via Facebook">
					<svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><rect x="0" fill="none" width="24" height="24"></rect><g><path fill="#3B5998" d="M20.007 3H3.993C3.445 3 3 3.445 3 3.993v16.013c0 .55.445.994.993.994h8.62v-6.97H10.27V11.31h2.346V9.31c0-2.325 1.42-3.59 3.494-3.59.993 0 1.847.073 2.096.106v2.43h-1.438c-1.128 0-1.346.537-1.346 1.324v1.734h2.69l-.35 2.717h-2.34V21h4.587c.548 0 .993-.445.993-.993V3.993c0-.548-.445-.993-.993-.993z"></path></g></svg>				</a>
			</li>
		</ul>
	</div>

	<div id="comment-form-guest" class="comment-form-service selected">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
<a href="https://gravatar.com/site/signup/" target="_blank">				<img src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/ad516503a11cd5ca435acc9bb6523536" alt="Gravatar" width="25" class="no-grav grav-hashed grav-hijack" id="grav-ad516503a11cd5ca435acc9bb6523536-0">
</a>			</div>

				<div class="comment-form-fields">
				<div class="comment-form-field comment-form-email">
					<label for="email">Email <span class="required">(required)</span> <span class="nopublish">(Address never made public)</span></label>
					<div class="comment-form-input"><input id="email" name="email" type="email" value=""></div>
				</div>
				<div class="comment-form-field comment-form-author">
					<label for="author">Name <span class="required">(required)</span></label>
					<div class="comment-form-input"><input id="author" name="author" type="text" value=""></div>
				</div>
				<div class="comment-form-field comment-form-url">
					<label for="url">Website</label>
					<div class="comment-form-input"><input id="url" name="url" type="url" value=""></div>
				</div>
			</div>
			
		</div>
	</div>

	<div id="comment-form-wordpress" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/ad516503a11cd5ca435acc9bb6523536" alt="WordPress.com Logo" width="25" class="no-grav grav-hashed grav-hijack" id="grav-ad516503a11cd5ca435acc9bb6523536-1">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="wp_avatar" id="wordpress-avatar" class="comment-meta-wordpress" value="">
				<input type="hidden" name="wp_user_id" id="wordpress-user_id" class="comment-meta-wordpress" value="">
				<input type="hidden" name="wp_access_token" id="wordpress-access_token" class="comment-meta-wordpress" value="">
						<p class="comment-form-posting-as pa-wordpress">
			<strong></strong>
			You are commenting using your WordPress.com account.			<span class="comment-form-log-out">
				(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( &#39;wordpress&#39; );">Log&nbsp;Out</a>&nbsp;/&nbsp;
				<a href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)
			</span>
			<span class="pa-icon"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><rect x="0" fill="none" width="24" height="24"></rect><g><path fill="#0087be" d="M12.158 12.786l-2.698 7.84c.806.236 1.657.365 2.54.365 1.047 0 2.05-.18 2.986-.51-.024-.037-.046-.078-.065-.123l-2.762-7.57zM3.008 12c0 3.56 2.07 6.634 5.068 8.092L3.788 8.342c-.5 1.117-.78 2.354-.78 3.658zm15.06-.454c0-1.112-.398-1.88-.74-2.48-.456-.74-.883-1.368-.883-2.11 0-.825.627-1.595 1.51-1.595.04 0 .078.006.116.008-1.598-1.464-3.73-2.36-6.07-2.36-3.14 0-5.904 1.613-7.512 4.053.21.008.41.012.58.012.94 0 2.395-.114 2.395-.114.484-.028.54.684.057.74 0 0-.487.058-1.03.086l3.275 9.74 1.968-5.902-1.4-3.838c-.485-.028-.944-.085-.944-.085-.486-.03-.43-.77.056-.742 0 0 1.484.114 2.368.114.94 0 2.397-.114 2.397-.114.486-.028.543.684.058.74 0 0-.488.058-1.03.086l3.25 9.665.897-2.997c.456-1.17.684-2.137.684-2.907zm1.82-3.86c.04.286.06.593.06.924 0 .912-.17 1.938-.683 3.22l-2.746 7.94c2.672-1.558 4.47-4.454 4.47-7.77 0-1.564-.4-3.033-1.1-4.314zM12 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10z"></path></g></svg></span>
		</p>
					</div>
	
		</div>
	</div>

	<div id="comment-form-googleplus" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/ad516503a11cd5ca435acc9bb6523536" alt="Google photo" width="25" class="no-grav grav-hashed grav-hijack" id="grav-ad516503a11cd5ca435acc9bb6523536-2">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="googleplus_avatar" id="googleplus-avatar" class="comment-meta-googleplus" value="">
				<input type="hidden" name="googleplus_user_id" id="googleplus-user_id" class="comment-meta-googleplus" value="">
				<input type="hidden" name="googleplus_access_token" id="googleplus-access_token" class="comment-meta-googleplus" value="">
						<p class="comment-form-posting-as pa-googleplus">
			<strong></strong>
			You are commenting using your Google account.			<span class="comment-form-log-out">
				(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( &#39;googleplus&#39; );">Log&nbsp;Out</a>&nbsp;/&nbsp;
				<a href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)
			</span>
			<span class="pa-icon"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" x="0px" y="0px" viewBox="0 0 60 60"><path fill="#519bf7" d="M56.3,30c0,-1.6 -0.2,-3.4 -0.6,-5h-3.1H42.2H30v10.6h14.8C44,39.3 42,42 39.1,43.9l8.8,6.8C53,46 56.3,39 56.3,30z"></path><path fill="#3db366" d="M30,57.5c6.7,0 13.1,-2.4 17.9,-6.8l-8.8,-6.8c-2.5,1.6 -5.6,2.4 -9.1,2.4c-7.2,0 -13.3,-4.7 -15.4,-11.2l-9.3,7.1C9.8,51.3 19.1,57.5 30,57.5z"></path><path fill="#fdc600" d="M5.3,42.2l9.3,-7.1c-0.5,-1.6 -0.8,-3.3 -0.8,-5.1s0.3,-3.5 0.8,-5.1l-9.3,-7.1C3.5,21.5 2.5,25.6 2.5,30S3.5,38.5 5.3,42.2z"></path><path fill="#f15b44" d="M40.1,17.4l8,-8C43.3,5.1 37,2.5 30,2.5C19.1,2.5 9.8,8.7 5.3,17.8l9.3,7.1c2.1,-6.5 8.2,-11.1 15.4,-11.1C33.9,13.7 37.4,15.1 40.1,17.4z"></path></svg></span>
		</p>
					</div>
	
		</div>
	</div>

	<div id="comment-form-twitter" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/ad516503a11cd5ca435acc9bb6523536" alt="Twitter picture" width="25" class="no-grav grav-hashed grav-hijack" id="grav-ad516503a11cd5ca435acc9bb6523536-3">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="twitter_avatar" id="twitter-avatar" class="comment-meta-twitter" value="">
				<input type="hidden" name="twitter_user_id" id="twitter-user_id" class="comment-meta-twitter" value="">
				<input type="hidden" name="twitter_access_token" id="twitter-access_token" class="comment-meta-twitter" value="">
						<p class="comment-form-posting-as pa-twitter">
			<strong></strong>
			You are commenting using your Twitter account.			<span class="comment-form-log-out">
				(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( &#39;twitter&#39; );">Log&nbsp;Out</a>&nbsp;/&nbsp;
				<a href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)
			</span>
			<span class="pa-icon"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><rect x="0" fill="none" width="24" height="24"></rect><g><path fill="#1DA1F2" d="M22.23 5.924c-.736.326-1.527.547-2.357.646.847-.508 1.498-1.312 1.804-2.27-.793.47-1.67.812-2.606.996C18.325 4.498 17.258 4 16.078 4c-2.266 0-4.103 1.837-4.103 4.103 0 .322.036.635.106.935-3.41-.17-6.433-1.804-8.457-4.287-.353.607-.556 1.312-.556 2.064 0 1.424.724 2.68 1.825 3.415-.673-.022-1.305-.207-1.86-.514v.052c0 1.988 1.415 3.647 3.293 4.023-.344.095-.707.145-1.08.145-.265 0-.522-.026-.773-.074.522 1.63 2.038 2.817 3.833 2.85-1.404 1.1-3.174 1.757-5.096 1.757-.332 0-.66-.02-.98-.057 1.816 1.164 3.973 1.843 6.29 1.843 7.547 0 11.675-6.252 11.675-11.675 0-.178-.004-.355-.012-.53.802-.578 1.497-1.3 2.047-2.124z"></path></g></svg></span>
		</p>
					</div>
	
		</div>
	</div>

	<div id="comment-form-facebook" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/" alt="Facebook photo" width="25" class="no-grav">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="fb_avatar" id="facebook-avatar" class="comment-meta-facebook" value="">
				<input type="hidden" name="fb_user_id" id="facebook-user_id" class="comment-meta-facebook" value="">
				<input type="hidden" name="fb_access_token" id="facebook-access_token" class="comment-meta-facebook" value="">
						<p class="comment-form-posting-as pa-facebook">
			<strong></strong>
			You are commenting using your Facebook account.			<span class="comment-form-log-out">
				(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( &#39;facebook&#39; );">Log&nbsp;Out</a>&nbsp;/&nbsp;
				<a href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)
			</span>
			<span class="pa-icon"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><rect x="0" fill="none" width="24" height="24"></rect><g><path fill="#3B5998" d="M20.007 3H3.993C3.445 3 3 3.445 3 3.993v16.013c0 .55.445.994.993.994h8.62v-6.97H10.27V11.31h2.346V9.31c0-2.325 1.42-3.59 3.494-3.59.993 0 1.847.073 2.096.106v2.43h-1.438c-1.128 0-1.346.537-1.346 1.324v1.734h2.69l-.35 2.717h-2.34V21h4.587c.548 0 .993-.445.993-.993V3.993c0-.548-.445-.993-.993-.993z"></path></g></svg></span>
		</p>
					</div>
	
		</div>
	</div>


	<div id="comment-form-load-service" class="comment-form-service">
		<div class="comment-form-posting-as-cancel"><a href="javascript:HighlanderComments.cancelExternalWindow();">Cancel</a></div>
		<p>Connecting to %s</p>
	</div>

</div>

<script type="text/javascript">
var highlander_expando_javascript = function () {

	function hide( sel ) {
		var el = document.querySelector( sel );
		if ( el ) {
			el.style.setProperty( 'display', 'none' );
		}
	}

	function show( sel ) {
		var el = document.querySelector( sel );
		if ( el ) {
			el.style.removeProperty( 'display' );
		}
	}

	var input = document.createElement( 'input' );
	var comment = document.querySelector( '#comment' );

	if ( input && comment && 'placeholder' in input ) {
		var label = document.querySelector( '.comment-textarea label' );
		if ( label ) {
			var text = label.textContent;
			label.parentNode.removeChild( label );
			comment.setAttribute( 'placeholder', text );
		}
	}

	// Expando Mode: start small, then auto-resize on first click + text length
	hide( '#comment-form-identity' );
	hide( '#comment-form-subscribe' );
	hide( '#commentform .form-submit' );

	if ( comment ) {
		comment.style.height = '10px';

		var handler = function () {
			comment.style.height = HighlanderComments.initialHeight + 'px';
			show( '#comment-form-identity' );
			show( '#comment-form-subscribe' );
			show( '#commentform .form-submit' );
			HighlanderComments.resizeCallback();

			comment.removeEventListener( 'focus', handler );
		};

		comment.addEventListener( 'focus', handler );
	}
}

if ( document.readyState !== 'loading' ) {
	highlander_expando_javascript();
} else {
	if ( typeof window.jQuery === 'function' ) {
		// Use jQuery's `ready` if available.
		// This solves some scheduling issues between this script and the main highlander script.
		jQuery( document ).ready( highlander_expando_javascript );
	} else {
		// If not available, add a vanilla event listener.
		document.addEventListener( 'DOMContentLoaded', highlander_expando_javascript );
	}
}

</script>

<div id="comment-form-subscribe" style="display: none;">
	<p class="comment-subscription-form"><input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;"> <label class="subscribe-label" id="subscribe-label" for="subscribe" style="display: inline;">Notify me of new comments via email.</label></p><p class="post-subscription-form"><input type="checkbox" name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto;"> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog" style="display: inline;">Notify me of new posts via email.</label></p></div>




<p class="form-submit wp-block-button" style="display: none;"><input name="submit" type="submit" id="comment-submit" class="submit wp-block-button__link" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="3388" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="e7bc4f3bab"></p>
<input type="hidden" name="genseq" value="1631013505">
<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea><input type="hidden" id="ak_js" name="ak_js" value="1631013509136"></form>	</div><!-- #respond -->
	<div style="clear: both"></div><p class="akismet_comment_form_privacy_notice">This site uses Akismet to reduce spam. <a href="https://akismet.com/privacy/" target="_blank" rel="nofollow noopener">Learn how your comment data is processed</a>.</p>
</div><!-- #comments -->
		</main><!-- #main -->
	</div><!-- #primary -->
	</div><!-- .wrap -->

	</div>

	
	<footer id="colophon" class="site-footer" role="contentinfo">
		


	<aside class="widget-area" role="complementary">
		<div class="wrap">
							<div class="widget-column">
					<section id="block-3" class="widget widget_block widget_search"><form role="search" method="get" action="https://smsagent.blog/" class="wp-block-search__button-outside wp-block-search__text-button wp-block-search"><label for="wp-block-search__input-1" class="wp-block-search__label">Search</label><div class="wp-block-search__inside-wrapper "><input type="search" id="wp-block-search__input-1" class="wp-block-search__input " name="s" value="" placeholder="" required=""><button type="submit" class="wp-block-search__button ">Search</button></div></form></section>				</div>
							<div class="widget-column">
					<section id="blog-stats-4" class="widget widget_blog-stats"><h2 class="widget-title">Blog Stats</h2>		<ul>
			<li>1,070,964 hits</li>
		</ul>
		</section>				</div>
							<div class="widget-column">
					<section id="blog_subscription-5" class="widget widget_blog_subscription jetpack_subscription_widget"><h2 class="widget-title"><label for="subscribe-field">Subscribe to Blog via Email</label></h2>
			<form action="https://subscribe.wordpress.com/" method="post" accept-charset="utf-8" id="">
				<p>Enter your email address to subscribe to this blog and receive notifications of new posts by email.</p>
					<div class="jetpack-subscribe-count">
						<p>
						Join 2,110 other followers						</p>
					</div>
									<p id="subscribe-email">
					<label id="subscribe-field-label" for="subscribe-field" class="screen-reader-text">
						Email Address:					</label>

					<input type="email" name="email" style="width: 95%; padding: 1px 10px" placeholder="Enter your email address" value="" id="subscribe-field">				</p>

				<p id="subscribe-submit">
                    <input type="hidden" name="action" value="subscribe">
                    <input type="hidden" name="blog_id" value="63076196">
                    <input type="hidden" name="source" value="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/">
                    <input type="hidden" name="sub-type" value="widget">
                    <input type="hidden" name="redirect_fragment" value="blog_subscription-5">
					<input type="hidden" id="_wpnonce" name="_wpnonce" value="52a593cd3d">                    <button type="submit">
	                    Subscribe                    </button>
                </p>
            </form>
			
</section>					</div>
	</div></aside><!-- .widget-area -->

<div class="site-info">
	<div class="wrap">
		<a href="https://wordpress.com/?ref=footer_blog" rel="nofollow">Blog at WordPress.com.</a>
		
			</div><!-- .wrap -->
</div><!-- .site-info -->
	</footer>
</div><!-- #page -->
<!--  -->
<script src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/gprofiles.js.download" id="grofiles-cards-js"></script>
<script id="wpgroho-js-extra">
var WPGroHo = {"my_hash":""};
</script>
<script crossorigin="anonymous" type="text/javascript" src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/wpgroho.js.download"></script>

	<script>
		// Initialize and attach hovercards to all gravatars
		( function() {
			function init() {
				if ( typeof Gravatar === 'undefined' ) {
					return;
				}

				if ( typeof Gravatar.init !== 'function' ) {
					return;
				}

				Gravatar.profile_cb = function ( hash, id ) {
					WPGroHo.syncProfileData( hash, id );
				};

				Gravatar.my_hash = WPGroHo.my_hash;
				Gravatar.init( 'body', '#wp-admin-bar-my-account' );
			}

			if ( document.readyState !== 'loading' ) {
				init();
			} else {
				document.addEventListener( 'DOMContentLoaded', init );
			}
		} )();
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-82c90a29b90193456711fa794f5d849c">
	</div>
	<div class="grofile-hash-map-3521330a578fe7efbfe3043f7b9a3d6b">
	</div>
	<div class="grofile-hash-map-82c90a29b90193456711fa794f5d849c">
	</div>
	</div>
<script id="highlander-comments-js-extra">
var HighlanderComments = {"loggingInText":"Logging In\u2026","submittingText":"Posting Comment\u2026","postCommentText":"Post Comment","connectingToText":"Connecting to %s","commentingAsText":"%1$s: You are commenting using your %2$s account.","logoutText":"Log Out","loginText":"Log In","connectURL":"https:\/\/smsagent.wordpress.com\/public.api\/connect\/?action=request&domain=smsagent.blog","logoutURL":"https:\/\/smsagent.wordpress.com\/wp-login.php?action=logout&_wpnonce=87ec07960e","homeURL":"https:\/\/smsagent.blog\/","postID":"3388","gravDefault":"identicon","enterACommentError":"Please enter a comment","enterEmailError":"Please enter your email address here","invalidEmailError":"Invalid email address","enterAuthorError":"Please enter your name here","gravatarFromEmail":"This picture will show whenever you leave a comment. Click to customize it.","logInToExternalAccount":"Log in to use details from one of these accounts.","change":"Change","changeAccount":"Change Account","comment_registration":"","userIsLoggedIn":"","isJetpack":"","text_direction":"ltr"};
</script>
<script crossorigin="anonymous" type="text/javascript" src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/saved_resource(6)"></script>

<script>
window.addEventListener( "load", function( event ) {
	var link = document.createElement( "link" );
	link.href = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.css?v=20210901";
	link.type = "text/css";
	link.rel = "stylesheet";
	document.head.appendChild( link );

	var script = document.createElement( "script" );
	script.src = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.js?v=20210901";
	script.defer = true;
	document.body.appendChild( script );
} );
</script>

			<div id="jp-carousel-loading-overlay">
			<div id="jp-carousel-loading-wrapper">
				<span id="jp-carousel-library-loading">&nbsp;</span>
			</div>
		</div>
		<div class="jp-carousel-overlay" style="display: none;">

		<div class="jp-carousel-container">
			<!-- The Carousel Swiper -->
			<div class="jp-carousel-wrap swiper-container jp-carousel-swiper-container jp-carousel-transitions" itemscope="" itemtype="https://schema.org/ImageGallery">
				<div class="jp-carousel swiper-wrapper"></div>
				<div class="jp-swiper-button-prev swiper-button-prev">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskPrev" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="9" height="12">
							<path d="M16.2072 16.59L11.6496 12L16.2072 7.41L14.8041 6L8.8335 12L14.8041 18L16.2072 16.59Z" fill="white"></path>
						</mask>
						<g mask="url(#maskPrev)">
							<rect x="0.579102" width="23.8823" height="24" fill="#FFFFFF"></rect>
						</g>
					</svg>
				</div>
				<div class="jp-swiper-button-next swiper-button-next">
					<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<mask id="maskNext" mask-type="alpha" maskUnits="userSpaceOnUse" x="8" y="6" width="8" height="12">
							<path d="M8.59814 16.59L13.1557 12L8.59814 7.41L10.0012 6L15.9718 12L10.0012 18L8.59814 16.59Z" fill="white"></path>
						</mask>
						<g mask="url(#maskNext)">
							<rect x="0.34375" width="23.8822" height="24" fill="#FFFFFF"></rect>
						</g>
					</svg>
				</div>
			</div>
			<!-- The main close buton -->
			<div class="jp-carousel-close-hint">
				<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<mask id="maskClose" mask-type="alpha" maskUnits="userSpaceOnUse" x="5" y="5" width="15" height="14">
						<path d="M19.3166 6.41L17.9135 5L12.3509 10.59L6.78834 5L5.38525 6.41L10.9478 12L5.38525 17.59L6.78834 19L12.3509 13.41L17.9135 19L19.3166 17.59L13.754 12L19.3166 6.41Z" fill="white"></path>
					</mask>
					<g mask="url(#maskClose)">
						<rect x="0.409668" width="23.8823" height="24" fill="#FFFFFF"></rect>
					</g>
				</svg>
			</div>
			<!-- Image info, comments and meta -->
			<div class="jp-carousel-info">
				<div class="jp-carousel-info-footer">
					<div class="jp-carousel-pagination-container">
						<div class="jp-swiper-pagination swiper-pagination"></div>
						<div class="jp-carousel-pagination"></div>
					</div>
					<div class="jp-carousel-photo-title-container">
						<h2 class="jp-carousel-photo-caption"></h2>
					</div>
					<div class="jp-carousel-photo-icons-container">
						<a href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/#" class="jp-carousel-icon-btn jp-carousel-icon-info" aria-label="Toggle photo metadata visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskInfo" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M12.7537 2C7.26076 2 2.80273 6.48 2.80273 12C2.80273 17.52 7.26076 22 12.7537 22C18.2466 22 22.7046 17.52 22.7046 12C22.7046 6.48 18.2466 2 12.7537 2ZM11.7586 7V9H13.7488V7H11.7586ZM11.7586 11V17H13.7488V11H11.7586ZM4.79292 12C4.79292 16.41 8.36531 20 12.7537 20C17.142 20 20.7144 16.41 20.7144 12C20.7144 7.59 17.142 4 12.7537 4C8.36531 4 4.79292 7.59 4.79292 12Z" fill="white"></path>
									</mask>
									<g mask="url(#maskInfo)">
										<rect x="0.8125" width="23.8823" height="24" fill="#FFFFFF"></rect>
									</g>
								</svg>
							</span>
						</a>
												<a href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/#" class="jp-carousel-icon-btn jp-carousel-icon-comments" aria-label="Toggle photo comments visibility">
							<span class="jp-carousel-icon">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="maskComments" mask-type="alpha" maskUnits="userSpaceOnUse" x="2" y="2" width="21" height="20">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M4.3271 2H20.2486C21.3432 2 22.2388 2.9 22.2388 4V16C22.2388 17.1 21.3432 18 20.2486 18H6.31729L2.33691 22V4C2.33691 2.9 3.2325 2 4.3271 2ZM6.31729 16H20.2486V4H4.3271V18L6.31729 16Z" fill="white"></path>
									</mask>
									<g mask="url(#maskComments)">
										<rect x="0.34668" width="23.8823" height="24" fill="#FFFFFF"></rect>
									</g>
								</svg>

								<span class="jp-carousel-has-comments-indicator" aria-label="This image has comments."></span>
							</span>
						</a>
											</div>
				</div>
				<div class="jp-carousel-info-extra">
					<div class="jp-carousel-info-content-wrapper">
						<div class="jp-carousel-photo-title-container">
							<h2 class="jp-carousel-photo-title"></h2>
						</div>
						<div class="jp-carousel-comments-wrapper">
															<div id="jp-carousel-comments-loading">
									<span>Loading Comments...</span>
								</div>
								<div class="jp-carousel-comments"></div>
								<div id="jp-carousel-comment-form-container">
									<span id="jp-carousel-comment-form-spinner">&nbsp;</span>
									<div id="jp-carousel-comment-post-results"></div>
																														<form id="jp-carousel-comment-form">
												<label for="jp-carousel-comment-form-comment-field" class="screen-reader-text">Write a Comment...</label>
												<textarea name="comment" class="jp-carousel-comment-form-field jp-carousel-comment-form-textarea" id="jp-carousel-comment-form-comment-field" placeholder="Write a Comment..."></textarea>
												<div id="jp-carousel-comment-form-submit-and-info-wrapper">
													<div id="jp-carousel-comment-form-commenting-as">
																													<fieldset>
																<label for="jp-carousel-comment-form-email-field">Email (Required)</label>
																<input type="text" name="email" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-email-field">
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-author-field">Name (Required)</label>
																<input type="text" name="author" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-author-field">
															</fieldset>
															<fieldset>
																<label for="jp-carousel-comment-form-url-field">Website</label>
																<input type="text" name="url" class="jp-carousel-comment-form-field jp-carousel-comment-form-text-field" id="jp-carousel-comment-form-url-field">
															</fieldset>
																											</div>
													<input type="submit" name="submit" class="jp-carousel-comment-form-button" id="jp-carousel-comment-form-button-submit" value="Post Comment">
												</div>
											</form>
																											</div>
													</div>
						<div class="jp-carousel-image-meta">
							<div class="jp-carousel-title-and-caption">
								<div class="jp-carousel-photo-info">
									<h3 class="jp-carousel-caption" itemprop="caption description"></h3>
								</div>

								<div class="jp-carousel-photo-description"></div>
							</div>
							<ul class="jp-carousel-image-exif" style="display: none;"></ul>
							<a class="jp-carousel-image-download" target="_blank" style="display: none;">
								<svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
									<mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="3" y="3" width="19" height="18">
										<path fill-rule="evenodd" clip-rule="evenodd" d="M5.84615 5V19H19.7775V12H21.7677V19C21.7677 20.1 20.8721 21 19.7775 21H5.84615C4.74159 21 3.85596 20.1 3.85596 19V5C3.85596 3.9 4.74159 3 5.84615 3H12.8118V5H5.84615ZM14.802 5V3H21.7677V10H19.7775V6.41L9.99569 16.24L8.59261 14.83L18.3744 5H14.802Z" fill="white"></path>
									</mask>
									<g mask="url(#mask0)">
										<rect x="0.870605" width="23.8823" height="24" fill="#FFFFFF"></rect>
									</g>
								</svg>
								<span class="jp-carousel-download-text"></span>
							</a>
							<div class="jp-carousel-image-map" style="display: none;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		</div>
		
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/smsagent.blog\/2017\/02\/17\/powershell-tip-create-background-jobs-with-a-custom-class\/":3388};
	</script>
					
<script crossorigin="anonymous" type="text/javascript" src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/saved_resource(7)"></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://s1.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.head.appendChild( corecss );
		var themecssurl = "https://s2.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?m=1363304414h&amp;ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		document.head.appendChild( themecss );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();

	// Infinite scroll support
	if ( typeof( jQuery ) !== 'undefined' ) {
		jQuery( function( $ ) {
			$( document.body ).on( 'post-load', function() {
				SyntaxHighlighter.highlight();
			} );
		} );
	}
</script>
<link rel="stylesheet" id="all-css-0-3" href="./PowerShell Tip! Create Background Jobs with a Custom Class_files/saved_resource(8)" type="text/css" media="all">
<script id="jetpack-carousel-js-extra">
var jetpackSwiperLibraryPath = {"url":"\/wp-content\/mu-plugins\/carousel\/swiper-bundle.js"};
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/smsagent.blog\/wp-admin\/admin-ajax.php","nonce":"e079999f2a","display_exif":"1","display_comments":"1","display_geo":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/smsagent.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fsmsagent.blog%2F2017%2F02%2F17%2Fpowershell-tip-create-background-jobs-with-a-custom-class%2F","blog_id":"63076196","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"stats_query_args":"blog=63076196&v=wpcom&tz=0&user_id=0&subd=smsagent","is_public":"1"};
</script>
<script id="sharing-js-js-extra">
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
</script>
<script async="true" src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/saved_resource(9)"></script><script crossorigin="anonymous" type="text/javascript" src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/saved_resource(10)"></script>
<script type="text/javascript">
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-linkedin' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-linkedin' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
						return false;
					}
				} );
			} )();
</script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script>	<iframe src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/master.html" scrolling="no" id="likes-master" name="likes-master" style="display:none;"></iframe>
	<div id="likes-other-gravatars">
		<div class="likes-text">
			<span>%d</span> bloggers like this:		</div>
		<ul class="wpl-avatars sd-like-gravatars"></ul>
	</div>
	
		<script src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/w.js.download" defer=""></script> <script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'63076196','blog_tz':'0','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'63076196','v':'wpcom','tz':'0','user_id':'0','post':'3388','subd':'smsagent'}]);
_stq.push(['extra', {'crypt':'UE40eW5QN0p8M2Y/RE1TaVhzUzFMbjdWNHpwZGhTayxPSUFCMGNrd29+Smw0TDhnZmRTK0hlRi9QSGh6bi9GXVhBJWIlZlR5U1JMLU8/MkNtblkvY1dTTWQzalZQT1kyPzNNMy12XUZlK1VEaF9ZMkRhXS9kfnpXU3U3LUtbLSZsakpoUnExOGVDJWhWOExffFJJZkphaSVQRzVpTk58eltoaSZkdG9XaVkudTNYTU4xW1NOMnZOeGpaaXRRLHxuLnZtOVlnTiYuWXNPSitmOFY0MF10eDVpTzcuRDlbSyx5c2xEZF9OTTksckImMXRpUUtWQkJbQXFyb1FobTAwQTRVZEpXRGJSP05qQ2VVb3VyUlZZS0JbXTRzZ2d5bVVIWWlWOWx+dlQ2QkNmZGZIQXp6JjhdT1VdeFs='}]);
_stq.push([ 'clickTrackerInit', '63076196', '3388' ]);
	</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:1px;width:1px;overflow:hidden;position:absolute;bottom:1px;" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>


<img src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/g.gif" alt=":)" id="wpstats"><div id="sharing_email" style="display: none;">
		<form action="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/" method="post">
			<label for="target_email">Send to Email Address</label>
			<input type="email" name="target_email" id="target_email" value="">

			
				<label for="source_name">Your Name</label>
				<input type="text" name="source_name" id="source_name" value="">

				<label for="source_email">Your Email Address</label>
				<input type="email" name="source_email" id="source_email" value="">

						<input type="text" id="jetpack-source_f_name" name="source_f_name" class="input" value="" size="25" autocomplete="off" title="This field is for validation and should not be changed">
			
			<div class="g-recaptcha" data-sitekey="6LcmyE0UAAAAALID28yVNg7pFCodGaArJzHitez_" data-theme="light" data-type="image" data-tabindex="0" data-lazy="true" data-url="https://www.google.com/recaptcha/api.js?hl=en"></div>
			
			<img style="float: right; display: none" class="loading" src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/loading.gif" alt="loading" width="16" height="16">
			<input type="submit" value="Send Email" class="sharing_send">
			<a rel="nofollow" href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/#cancel" class="sharing_cancel" role="button">Cancel</a>

			<div class="errors errors-1" style="display: none;">
				Post was not sent - check your email addresses!			</div>

			<div class="errors errors-2" style="display: none;">
				Email check failed, please try again			</div>

			<div class="errors errors-3" style="display: none;">
				Sorry, your blog cannot share posts by email.			</div>
		</form>
	</div><iframe src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/saved_resource(11).html" style="display: none;"></iframe><script src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/actionbar.js.download" defer=""></script><div id="actionbar" class="actnbr-pub-lodestar actnbr-has-follow actnbr-hidden"><ul><li class="actnbr-btn actnbr-hidden"> 				<a class="actnbr-action actnbr-actn-follow" href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/"><svg class="gridicon gridicon__follow" height="24px" width="24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M23 16v2h-3v3h-2v-3h-3v-2h3v-3h2v3h3zM20 2v9h-4v3h-3v4H4c-1.1 0-2-.9-2-2V2h18zM8 13v-1H4v1h4zm3-3H4v1h7v-1zm0-2H4v1h7V8zm7-4H4v2h14V4z"></path></g></svg><span>Follow</span></a><a class="actnbr-action actnbr-actn-following no-display" href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/"><svg class="gridicon gridicon__following" height="24px" width="24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M23 13.482L15.508 21 12 17.4l1.412-1.388 2.106 2.188 6.094-6.094L23 13.482zm-7.455 1.862L20 10.89V2H2v14c0 1.1.9 2 2 2h4.538l4.913-4.832 2.095 2.176zM8 13H4v-1h4v1zm3-2H4v-1h7v1zm0-2H4V8h7v1zm7-3H4V4h14v2z"></path></g></svg><span>Following</span></a> 				<div class="actnbr-popover tip tip-top-left actnbr-notice"> 					<div class="tip-arrow"></div> 					<div class="tip-inner actnbr-follow-bubble"> 				<ul> 					<li class="actnbr-sitename actnbr-hidden"><a href="https://smsagent.blog/"><img alt="" src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/cropped-smsagent-11.png" class="avatar avatar-50" height="50" width="50"> smsagent.blog</a></li> 					<form> 					<li class="actnbr-login-nudge actnbr-hidden"><div>Already have a WordPress.com account? <a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fsmsagent.blog%252F2017%252F02%252F17%252Fpowershell-tip-create-background-jobs-with-a-custom-class%252F">Log in now.</a></div></li> 				</form></ul> 			</div> 				</div> 					</li><li class="actnbr-ellipsis actnbr-hidden"> 				<svg class="gridicon gridicon__ellipsis" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><circle cx="5" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="12" cy="12" r="2"></circle></g></svg> 				<div class="actnbr-popover tip tip-top-left actnbr-more"> 				<div class="tip-arrow"></div> 				<div class="tip-inner"> 					<ul> 						<li class="actnbr-sitename actnbr-hidden"><a href="https://smsagent.blog/"><img alt="" src="./PowerShell Tip! Create Background Jobs with a Custom Class_files/cropped-smsagent-11.png" class="avatar avatar-50" height="50" width="50"> smsagent.blog</a></li> 					<li class="actnbr-folded-customize actnbr-hidden"><a href="https://smsagent.wordpress.com/wp-admin/customize.php?url=https%3A%2F%2Fsmsagent.wordpress.com%2F2017%2F02%2F17%2Fpowershell-tip-create-background-jobs-with-a-custom-class%2F"><svg class="gridicon gridicon__customize" height="20px" width="20px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M2 6c0-1.505.78-3.08 2-4 0 .845.69 2 2 2 1.657 0 3 1.343 3 3 0 .386-.08.752-.212 1.09.74.594 1.476 1.19 2.19 1.81L8.9 11.98c-.62-.716-1.214-1.454-1.807-2.192C6.753 9.92 6.387 10 6 10c-2.21 0-4-1.79-4-4zm12.152 6.848l1.34-1.34c.607.304 1.283.492 2.008.492 2.485 0 4.5-2.015 4.5-4.5 0-.725-.188-1.4-.493-2.007L18 9l-2-2 3.507-3.507C18.9 3.188 18.225 3 17.5 3 15.015 3 13 5.015 13 7.5c0 .725.188 1.4.493 2.007L3 20l2 2 6.848-6.848c1.885 1.928 3.874 3.753 5.977 5.45l1.425 1.148 1.5-1.5-1.15-1.425c-1.695-2.103-3.52-4.092-5.448-5.977z" data-reactid=".2.1.1:0.1b.0"></path></g></svg><span>Customize<span></span></span></a></li> 						<li class="actnbr-folded-follow actnbr-hidden"><a class="actnbr-action actnbr-actn-follow" href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/"><svg class="gridicon gridicon__follow" height="24px" width="24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M23 16v2h-3v3h-2v-3h-3v-2h3v-3h2v3h3zM20 2v9h-4v3h-3v4H4c-1.1 0-2-.9-2-2V2h18zM8 13v-1H4v1h4zm3-3H4v1h7v-1zm0-2H4v1h7V8zm7-4H4v2h14V4z"></path></g></svg><span>Follow</span></a><a class="actnbr-action actnbr-actn-following no-display" href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/"><svg class="gridicon gridicon__following" height="24px" width="24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M23 13.482L15.508 21 12 17.4l1.412-1.388 2.106 2.188 6.094-6.094L23 13.482zm-7.455 1.862L20 10.89V2H2v14c0 1.1.9 2 2 2h4.538l4.913-4.832 2.095 2.176zM8 13H4v-1h4v1zm3-2H4v-1h7v1zm0-2H4V8h7v1zm7-3H4V4h14v2z"></path></g></svg><span>Following</span></a></li> 					<li class="actnbr-signup actnbr-hidden"><a href="https://wordpress.com/start/">Sign up</a></li> 						<li class="actnbr-login actnbr-hidden"><a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Fsmsagent.blog%252F2017%252F02%252F17%252Fpowershell-tip-create-background-jobs-with-a-custom-class%252F">Log in</a></li> 						 						<li class="actnbr-shortlink actnbr-hidden"><a href="https://wp.me/p4gF00-SE">Copy shortlink</a></li> 						<li class="flb-report actnbr-hidden"><a href="http://en.wordpress.com/abuse/">Report this content</a></li> 						 						 						<li class="actnbr-subs actnbr-hidden"><a href="https://subscribe.wordpress.com/">Manage subscriptions</a></li> 						<li class="actnbr-fold actnbr-hidden"><a href="https://smsagent.blog/2017/02/17/powershell-tip-create-background-jobs-with-a-custom-class/">Collapse this bar</a></li> 						</ul> 					</div> 					</div> 				</li> 				</ul></div></body></html>